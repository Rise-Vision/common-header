"use strict";angular.module("risevision.common.components.loading",["angularSpinner"]).value("_rvGlobalSpinnerRegistry",[]),angular.module("risevision.common.components.loading").service("$loading",["$q","$rootScope","$document","_rvGlobalSpinnerRegistry",function(n,i,r,e){function t(n){e.indexOf(n)<0&&e.push(n)}function o(n){var i;(i=e.indexOf(n))>=0&&e.splice(i,1)}var a=this;this.start=function(n){n=angular.isArray(n)?n:[n];for(var r=0;r<n.length;r++)i.$broadcast("rv-spinner:start",n[r])},this.stop=function(n){n=angular.isArray(n)?n:[n];for(var r=0;r<n.length;r++)i.$broadcast("rv-spinner:stop",n[r])},angular.element(r[0].body).append('<div rv-global-spinner class="ng-hide" style="position: fixed; width: 100%; height: 100%; top: 0; left: 0; z-index: 1040; "></div>'),this.startGlobal=function(n){n=angular.isArray(n)?n:[n],angular.forEach(n,function(n){t(n)})},this.stopGlobal=function(n){n=angular.isArray(n)?n:[n],angular.forEach(n,function(n){o(n)})},this.stopSpinnerAfterPromise=function(r,e){r=angular.isArray(r)?r:[r];var t=function(){for(var n=0;n<r.length;n++)i.$broadcast("rv-spinner:stop",r[n])},o=angular.isArray(e)?n.all(e):e;o.then(function(){t()},function(){t()})},this.getDefaultSpinnerOptions=function(){return a.defaultSpinnerOptions},this.defaultSpinnerOptions={lines:13,length:20,width:10,radius:30,corners:1,rotate:0,direction:1,color:"#555",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"50%",left:"50%"}}]),angular.module("risevision.common.components.loading").directive("rvGlobalSpinner",["usSpinnerService","$compile","_rvGlobalSpinnerRegistry","$timeout","$rootScope",function(n,i,r,e,t){return{scope:!0,link:function(o,a){var s='<div ng-show="active" class="spinner-backdrop fade" ng-class="{in: active}" us-spinner="rvSpinnerOptions" spinner-key="_rv-global-spinner" ng-focus="spinnerFocused()"></div>';a.prepend(i(s)(o)),o.rvSpinnerOptions={lines:13,length:20,width:10,radius:30,corners:1,rotate:0,direction:1,color:"#555",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"50%",left:"50%"},o.registry=r,o.$watchCollection("registry",function(){o.registry.length>0?o.active=!0:o.active=!1}),o.$watch("active",function(n){n?a.removeClass("ng-hide"):a.addClass("ng-hide")}),o.spinnerFocused=function(){t.$broadcast("rv-spinner:global:focused")},e(function(){n.spin("_rv-global-spinner")}),o.active=!0}}}]),angular.module("risevision.common.components.loading").directive("rvSpinner",["usSpinnerService","$compile",function(n,i){return{scope:{backdropClass:"@rvSpinnerBackdropClass",rvSpinnerKey:"@rvSpinnerKey",rvSpinnerStartActive:"=?rvSpinnerStartActive",rvSpinnerOptions:"=rvSpinner"},link:function(r,e,t){r.active=angular.isDefined(t.rvSpinnerStartActive)&&"1"===t.rvSpinnerStartActive;var o='<div ng-show="active" class="spinner-backdrop fade {{backdropClass}}" ng-class="{in: active}" us-spinner="rvSpinnerOptions" spinner-key="{{rvSpinnerKey}}"';o+=t.rvSpinnerStartActive&&"1"===t.rvSpinnerStartActive?' spinner-start-active="1"></div>':"></div>",e.prepend(i(o)(r)),r.$on("rv-spinner:start",function(i,e){e===r.rvSpinnerKey&&(n.spin(e),r.active=!0)}),r.$on("rv-spinner:stop",function(i,e){e===r.rvSpinnerKey&&(n.stop(e),r.active=!1)})}}}]);