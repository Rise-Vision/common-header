<!-- Step 5 -->
<div id="checkout-review-purchase">
  <div id="errorBox" class="alert alert-danger" role="alert" ng-show="purchase.estimate.estimateError">
    <strong>Payment Processing Error</strong> {{purchase.estimate.estimateError}}
  </div>

  <div class="row">
    <div class="col-md-6 u_margin-sm-top">
      <p class="lead u_margin-sm-bottom">
        Purchasing For
      </p>
      <small>
        <b>{{selectedCompany.name}}</b><br>
        Company ID: {{selectedCompany.id}}
      </small>
    </div>
    <div class="col-md-6 u_margin-sm-top">
      <p class="lead u_margin-sm-bottom">
        Payment Method
        <button class="btn btn-link btn-xs" ng-click="setCurrentStep(3)">Edit</button>
      </p>
      <small>
        <b>{{purchase.paymentMethods.selectedCard.cardType}}</b>
        <br>{{purchase.paymentMethods.selectedCard.last4 | cardLastFour}}
        <br>Exp: {{purchase.paymentMethods.selectedCard.expMonth | paddedMonth}}/{{purchase.paymentMethods.selectedCard.expYear}}
      </small>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6 u_margin-sm-top">
      <p class="lead u_margin-sm-bottom">
        Billing Address
        <button class="btn btn-link btn-xs" ng-click="setCurrentStep(1)">Edit</button>
      </p>
      <small>
        {{purchase.contact.firstName}} {{purchase.contact.lastName}}<br>
        {{purchase.contact.email}}<br>
        {{purchase.billingAddress.name}}<br>
        {{purchase.billingAddress.street}}<br> 
        <span ng-show="purchase.billingAddress.unit">{{purchase.billingAddress.unit}}</span>
        {{purchase.billingAddress.city}}, <span ng-show="purchase.billingAddress.province">{{purchase.billingAddress.province}},</span> {{purchase.billingAddress.postalCode}}<br> 
        {{purchase.billingAddress.country | countryName}}
      </small>
    </div>
    <div class="col-md-6 u_margin-sm-top">
      <p class="lead u_margin-sm-bottom">
        Shipping Address
        <button class="btn btn-link btn-xs" ng-click="setCurrentStep(2)">Edit</button>
      </p>
      <small>
        {{purchase.shippingAddress.name}}<br>
        {{purchase.shippingAddress.street}}<br> 
        <span ng-show="purchase.shippingAddress.unit">{{purchase.shippingAddress.unit}}</span>
        {{purchase.shippingAddress.city}}, <span ng-show="purchase.shippingAddress.province">{{purchase.shippingAddress.province}},</span> {{purchase.shippingAddress.postalCode}}<br> 
        {{purchase.shippingAddress.country | countryName}}
      </small>
    </div>
  </div>
  <br/>
  <hr class="u_margin-xs-top u_margin-xs-bottom">
  <div class="row">
    <div class="col-xs-12">
      <p class="lead u_margin-sm-bottom">
        Subscription Details
        <button class="btn btn-link btn-xs" ng-click="setCurrentStep(0)">Edit</button>
      </p>
    </div>
  </div>
  <div class="row">
    <div class="col-sm-4 col-xs-6 text-right">
      <p>
        <small>{{purchase.plan.name}} ({{ purchase.plan.isMonthly ? 'Monthly' : 'Yearly' }})<br>
          <span ng-show="purchase.plan.additionalDisplayLicenses">{{purchase.plan.additionalDisplayLicenses}} Additional Display<span ng-show="purchase.plan.additionalDisplayLicenses > 1">s</span><br></span>
          <span ng-repeat="tax in purchase.estimate.taxes">
            {{tax.taxName}}<br>
          </span>
          Total Tax:
        </small>
      </p>
      <span class="order-total">Order Total:</span>
    </div>
    <div class="col-sm-4 col-xs-6 text-right">
      <p>
        <small>
          ${{getPlanPrice()}}<br>
          <span ng-show="purchase.plan.additionalDisplayLicenses">${{getAdditionalDisplaysPrice()}}<br></span>
          <span ng-repeat="tax in purchase.estimate.taxes">
            ${{tax.taxAmount | number:2}}<br>
          </span>
          ${{purchase.estimate.totalTax | number:2}}
        </small>
      </p>
      <span class="order-total">
        ${{purchase.estimate.total | number:2}}
        <small class="u_margin-left text-subtle">{{purchase.estimate.currency | uppercase}}</small>
      </span>
    </div>
    <div class="col-sm-4 col-xs-12 text-right" ng-if="false">
      <button id="showTaxExempt" class="btn btn-link btn-xs">Submit Tax Exemption</button>
    </div>
  </div>
  <div class="row">
    <hr class="u_margin-sm-top">
  </div>
  <div class="row">
    <div class="col-xs-8 col-xs-offset-2 u_margin-md-bottom">
      <button id="payButton" class="btn btn-primary btn-hg btn-block">
        <span id="payLabel">Pay ${{purchase.estimate.total | number:2}} Now</span>
      </button>
    </div>
  </div>
</div>
