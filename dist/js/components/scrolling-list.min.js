!function(e){"use strict";e.module("risevision.common.components.scrolling-list",["rvScrollEvent"]).value("BaseList",function(e){this.list=[],this.maxCount=e?e:40,this.cursor=null,this.endOfList=!1,this.searchString="",this.clear=function(){this.list=[],this.cursor=null,this.endOfList=!1},this.concat=function(e){this.list=this.list.concat(e)},this.add=function(e,r){this.cursor=r,this.endOfList=e.length<this.maxCount,this.concat(e)}})}(angular),angular.module("risevision.common.components.scrolling-list").service("processErrorCode",["$filter",function(e){var r={get:"loaded",load:"loaded",add:"added",update:"updated","delete":"deleted",publish:"published",restore:"restored",move:"moved",rename:"renamed",upload:"uploaded",restart:"restarted",reboot:"rebooted"};return function(t,s,o){var n=e("translate")("apps-common.errors.tryAgain"),i=r[s],a=o&&o.result&&o.result.error||{},c=a.message?a.message:"An Error has Occurred",l=e("translate")("apps-common.errors.actionFailed",{itemName:t,actionName:i}),u="storage-client.error."+(s?s+".":"")+a.message,m=e("translate")(u);return m!==u&&(c=m),o?400===o.status?c.indexOf("is not editable")>=0?l+" "+c:c.indexOf("is required")>=0?l+" "+c:l+" "+c:401===o.status?e("translate")("apps-common.errors.notAuthenticated",{itemName:t,actionName:s}):403===o.status?c.indexOf("User is not allowed access")>=0?l+" "+e("translate")("apps-common.errors.parentCompanyAction"):c.indexOf("User does not have the necessary rights")>=0?l+" "+e("translate")("apps-common.errors.permissionRequired"):c.indexOf("Premium Template requires Purchase")>=0?l+" "+e("translate")("apps-common.errors.premiumTemplate"):c.indexOf("Storage requires active subscription")>=0?l+" "+e("translate")("apps-common.errors.storageSubscription"):l+" "+c:404===o.status?e("translate")("apps-common.errors.notFound",{itemName:t}):409===o.status?l+" "+c:500===o.status||503===o.status?e("translate")("apps-common.errors.serverError",{itemName:t,actionName:s})+" "+n:o.status===-1||a.code===-1||0===a.code?e("translate")("apps-common.errors.checkConnection"):c:c}}]),angular.module("risevision.common.components.scrolling-list").service("ScrollingListService",["$log","BaseList","processErrorCode",function(e,r,t){return function(s,o){var n=40,i={};i.items=new r(n),i.search=o?o:{},_.defaults(i.search,{sortBy:"name",count:n,reverse:!1,name:"Items"});var a=function(){i.loadingItems=!1,i.errorMessage="",i.apiError=""};return i.load=function(){a(),(!i.items.list.length||!i.items.endOfList&&i.items.cursor)&&(i.loadingItems=!0,s(i.search,i.items.cursor).then(function(e){i.items.add(e.items?e.items:[],e.cursor)}).then(null,function(r){i.errorMessage="Failed to load "+i.search.name+".",i.apiError=t(i.search.name,"load",r),e.error(i.errorMessage,r)})["finally"](function(){i.loadingItems=!1}))},i.load(),i.sortBy=function(e){i.items.clear(),e!==i.search.sortBy?(i.search.sortBy=e,i.search.reverse=!1):i.search.reverse=!i.search.reverse,i.load()},i.doSearch=function(){i.items.clear(),i.load()},i}}]),function(e){"use strict";var r=150;e.module("rvScrollEvent",[]).directive("rvScrollEvent",["$parse","$window",function(e,t){return{scope:!1,link:function(s,o,n){var i,a,c=e(n.rvScrollEvent),l=o[0],u="scroll",m={x:0,y:0},d=function(){a=function(e){m.x=l.scrollLeft,m.y=l.scrollTop,p(e),f(),h(e,!1)},o.bind(u,a)},p=function(e){i=t.setInterval(function(){m.x===l.scrollLeft&&m.y===l.scrollTop?(t.clearInterval(i),d(),h(e,!0)):(m.x=l.scrollLeft,m.y=l.scrollTop)},r)},f=function(){o.unbind(u,a)},h=function(e,r){s.$apply(function(){c(s,{$event:e,isEndEvent:r})})};d()}}}])}(angular),function(e){"use strict";e.module("risevision.common.components.scrolling-list").directive("scrollingList",["$parse","$compile",function(e,r){return{restrict:"A",replace:!1,terminal:!0,priority:1e3,link:function(t,s,o){var n=e(o.scrollingList);t.handleScroll=function(e,r){r&&e.target.scrollTop&&e.target.scrollHeight-e.target.clientHeight-e.target.scrollTop<20&&n(t)},s.attr("rv-scroll-event","handleScroll($event, isEndEvent)"),s.removeAttr("scrolling-list"),r(s)(t)}}}])}(angular);