"use strict";angular.module("risevision.common.components.timeline-basic.services",[]),angular.module("risevision.common.components.timeline-basic",["risevision.common.components.timeline-basic.services","ui.bootstrap"]),angular.module("risevision.common.components.timeline-basic.services").factory("timelineBasicDescription",["$filter",function(e){var n={},i=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],l=function(n,i,l){var a="",t=new Date(n);return i?(t.setMinutes(t.getMinutes()+t.getTimezoneOffset()),a=e("date")(t,l)):a=e("date")(t,l),a};return n.updateLabel=function(e){var n="",a=[];if(e.allDay)n="All day";else if(e.startTime){var t="hh:mm a";n=n+l(e.startTime,e.useLocaldate,t)+" ",e.endTime&&(n=n+" to "+l(e.endTime,e.useLocaldate,t)+" ")}for(var r=0;r<e.recurrenceDaysOfWeek.length;r++)"Mon"===e.recurrenceDaysOfWeek[r]?a.push(i[1]):"Tue"===e.recurrenceDaysOfWeek[r]?a.push(i[2]):"Wed"===e.recurrenceDaysOfWeek[r]?a.push(i[3]):"Thu"===e.recurrenceDaysOfWeek[r]?a.push(i[4]):"Fri"===e.recurrenceDaysOfWeek[r]?a.push(i[5]):"Sat"===e.recurrenceDaysOfWeek[r]?a.push(i[6]):"Sun"===e.recurrenceDaysOfWeek[r]&&a.push(i[0]);return e.everyDay||0===a.length||7===a.length?n+=" every day":a.length>0&&(n=n+" every "+a.join(" ")),n},n}]),angular.module("risevision.common.components.timeline-basic.services").factory("TimelineBasicFactory",[function(){var e=function(e,n,i){var l=new Date;return i?l=new Date(Date.UTC(l.getFullYear(),l.getMonth(),l.getDate(),e,n,0)):(l.setHours(e),l.setMinutes(n),l.setSeconds(0),l=l.toLocaleDateString("en-US")+" "+l.toLocaleTimeString("en-US")),l},n=function(n){var i=n,l={weekly:{}},a=function(){for(var e=0;e<i.recurrenceDaysOfWeek.length;e++)"Mon"===i.recurrenceDaysOfWeek[e]?l.weekly.monday=!0:"Tue"===i.recurrenceDaysOfWeek[e]?l.weekly.tuesday=!0:"Wed"===i.recurrenceDaysOfWeek[e]?l.weekly.wednesday=!0:"Thu"===i.recurrenceDaysOfWeek[e]?l.weekly.thursday=!0:"Fri"===i.recurrenceDaysOfWeek[e]?l.weekly.friday=!0:"Sat"===i.recurrenceDaysOfWeek[e]?l.weekly.saturday=!0:"Sun"===i.recurrenceDaysOfWeek[e]&&(l.weekly.sunday=!0)},t=function(){i.allDay&&(i.startTime=e(8,0,i.useLocaldate),i.endTime=e(17,30,i.useLocaldate)),a()};t();var r=function(){i.recurrenceDaysOfWeek=[],l.weekly.monday&&i.recurrenceDaysOfWeek.push("Mon"),l.weekly.tuesday&&i.recurrenceDaysOfWeek.push("Tue"),l.weekly.wednesday&&i.recurrenceDaysOfWeek.push("Wed"),l.weekly.thursday&&i.recurrenceDaysOfWeek.push("Thu"),l.weekly.friday&&i.recurrenceDaysOfWeek.push("Fri"),l.weekly.saturday&&i.recurrenceDaysOfWeek.push("Sat"),l.weekly.sunday&&i.recurrenceDaysOfWeek.push("Sun")};this.save=function(){i.startTime=i.allDay?null:i.startTime,i.endTime=i.allDay?null:i.endTime,r()},this.timeline=i,this.recurrence=l};return n.getTimeline=function(e,n,i,l,a){var t=(a||[]).length,r=!i&&!l,c=0===t||7===t,s={useLocaldate:e,always:r&&c,allDay:r,everyDay:c,startTime:i||null,endTime:l||null,recurrenceDaysOfWeek:a||[]};return s},n}]),function(e){e.module("risevision.common.components.timeline-basic").directive("timelineBasicTextbox",["$modal","TimelineBasicFactory","timelineBasicDescription",function(n,i,l){return{restrict:"E",scope:{useLocaldate:"=",timeDefined:"=",startTime:"=",endTime:"=",recurrenceDaysOfWeek:"=",ngDisabled:"="},templateUrl:"timeline-basic/timeline-textbox.html",link:function(a){a.$watch("startTime",function(){a.timeline=i.getTimeline(a.useLocaldate,a.timeDefined,a.startTime,a.endTime,a.recurrenceDaysOfWeek),a.timeline.label=l.updateLabel(a.timeline)}),a.$watch("timeline.always",function(e){a.timeDefined=!e}),a.openModal=function(){if(!a.ngDisabled){var i=n.open({templateUrl:"timeline-basic/timeline-modal.html",controller:"timelineBasicModal",resolve:{timeline:function(){return e.copy(a.timeline)}},size:"md"});i.result.then(function(e){a.timeline=e,a.startTime=e.startTime,a.endTime=e.endTime,a.recurrenceDaysOfWeek=e.recurrenceDaysOfWeek,a.timeline.label=l.updateLabel(a.timeline)},function(){})}}}}}])}(angular),function(e){e.module("risevision.common.components.timeline-basic").controller("timelineBasicModal",["$scope","$modalInstance","timeline","TimelineBasicFactory",function(e,n,i,l){var a=new l(i);e.recurrence=a.recurrence,e.timeline=a.timeline,e.today=new Date,e.save=function(){a.save(),n.close(e.timeline)},e.close=function(){n.dismiss()}}])}(angular),function(e){try{e=angular.module("risevision.common.components.timeline-basic")}catch(n){e=angular.module("risevision.common.components.timeline-basic",[])}e.run(["$templateCache",function(e){e.put("timeline-basic/timeline-modal.html",'<div id="timelineModal"><div class="modal-header"><button type="button" class="close" ng-click="close()" aria-hidden="true"><i class="fa fa-times"></i></button><h3 class="modal-title">Edit Timeline</h3></div><div class="modal-body" stop-event="touchend"><form role="form" name="timelineDetails" novalidate=""><div class="timeline"><section><label class="control-label u_margin-sm-bottom"><input type="checkbox" ng-model="timeline.allDay"> <strong>All Day</strong></label><div class="row form-group" ng-hide="timeline.allDay"><div class="col-sm-4"><label class="control-label">Start Time</label><div class="time-picker"><timepicker id="startTime" ng-model="timeline.startTime" ng-change="changed()" hour-step="1" minute-step="15" show-meridian="true" datepicker-localdate="{{timeline.useLocaldate}}"></timepicker></div></div><div class="col-sm-4"><label class="control-label">End Time</label><div class="time-picker"><timepicker id="endTime" ng-model="timeline.endTime" ng-change="changed()" hour-step="1" minute-step="15" show-meridian="true" datepicker-localdate="{{timeline.useLocaldate}}"></timepicker></div></div></div></section><section><label class="control-label u_margin-sm-bottom"><input type="checkbox" ng-model="timeline.everyDay"> <strong>Every Day</strong></label> <label class="control-label u_margin-sm-bottom" for="recurrence" ng-hide="timeline.everyDay"><strong>Recurrence</strong></label><div class="recurrence-option" ng-hide="timeline.everyDay"><div class="form-group timelineWeekdays"><label class="control-label"><input type="checkbox" ng-model="recurrence.weekly.monday"> Monday</label> <label class="control-label"><input type="checkbox" ng-model="recurrence.weekly.tuesday"> Tuesday</label> <label class="control-label"><input type="checkbox" ng-model="recurrence.weekly.wednesday"> Wednesday</label> <label class="control-label"><input type="checkbox" ng-model="recurrence.weekly.thursday"> Thursday</label> <label class="control-label"><input type="checkbox" ng-model="recurrence.weekly.friday"> Friday</label> <label class="control-label"><input type="checkbox" ng-model="recurrence.weekly.saturday"> Saturday</label> <label class="control-label"><input type="checkbox" ng-model="recurrence.weekly.sunday"> Sunday</label></div></div></section></div></form></div><div class="modal-footer"><button type="button" class="btn btn-primary btn-fixed-width" ng-click="save()" ng-disabled="timelineDetails.$invalid">Apply <i class="fa fa-white fa-check icon-right"></i></button> <button type="button" class="btn btn-default btn-fixed-width" ng-click="close()">Cancel <i class="fa fa-times icon-right"></i></button></div></div>')}])}(),function(e){try{e=angular.module("risevision.common.components.timeline-basic")}catch(n){e=angular.module("risevision.common.components.timeline-basic",[])}e.run(["$templateCache",function(e){e.put("timeline-basic/timeline-textbox.html",'<label class="control-label control-label-secondary u_margin-left"><input ng-model="timeline.always" type="checkbox" ng-disabled="ngDisabled"> Always</label><div id="timelineTextbox" class="panel-editable u_remove-bottom u_clickable" ng-click="openModal()" ng-show="!timeline.always"><div class="label label-tag"><span id="timelineLabel" timeline="timeline">{{timeline.label}}</span></div></div>')}])}();