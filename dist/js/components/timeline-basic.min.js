"use strict";angular.module("risevision.common.components.timeline-basic.services",[]),angular.module("risevision.common.components.timeline-basic",["risevision.common.components.timeline-basic.services","ui.bootstrap"]),angular.module("risevision.common.components.timeline-basic.services").factory("timelineBasicDescription",["$filter",function(e){var i={},n=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],a=function(i,n,a){var l="",t=new Date(i);return n?(t.setMinutes(t.getMinutes()+t.getTimezoneOffset()),l=e("date")(t,a)):l=e("date")(t,a),l};return i.updateLabel=function(e){var i="",l=[];if(e.allDay)i="All day ";else if(e.startTime){var t="hh:mm a";i=i+a(e.startTime,e.useLocaldate,t)+" ",e.endTime&&(i=i+"to "+a(e.endTime,e.useLocaldate,t)+" ")}if(e.recurrenceDaysOfWeek)for(var c=0;c<e.recurrenceDaysOfWeek.length;c++)"Mon"===e.recurrenceDaysOfWeek[c]?l.push(n[1]):"Tue"===e.recurrenceDaysOfWeek[c]?l.push(n[2]):"Wed"===e.recurrenceDaysOfWeek[c]?l.push(n[3]):"Thu"===e.recurrenceDaysOfWeek[c]?l.push(n[4]):"Fri"===e.recurrenceDaysOfWeek[c]?l.push(n[5]):"Sat"===e.recurrenceDaysOfWeek[c]?l.push(n[6]):"Sun"===e.recurrenceDaysOfWeek[c]&&l.push(n[0]);return e.everyDay||0===l.length||7===l.length?i+="every day":l.length>0&&(i=i+"every "+l.join(" ")),i},i}]),angular.module("risevision.common.components.timeline-basic.services").factory("TimelineBasicFactory",[function(){var e=function(e,i,n){var a=new Date;return n?a=new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),e,i,0)):(a.setHours(e),a.setMinutes(i),a.setSeconds(0),a=a.toLocaleDateString("en-US")+" "+a.toLocaleTimeString("en-US")),a},i=function(i){var n=i,a={weekly:{}},l=function(){if(n.recurrenceDaysOfWeek)for(var e=0;e<n.recurrenceDaysOfWeek.length;e++)"Mon"===n.recurrenceDaysOfWeek[e]?a.weekly.monday=!0:"Tue"===n.recurrenceDaysOfWeek[e]?a.weekly.tuesday=!0:"Wed"===n.recurrenceDaysOfWeek[e]?a.weekly.wednesday=!0:"Thu"===n.recurrenceDaysOfWeek[e]?a.weekly.thursday=!0:"Fri"===n.recurrenceDaysOfWeek[e]?a.weekly.friday=!0:"Sat"===n.recurrenceDaysOfWeek[e]?a.weekly.saturday=!0:"Sun"===n.recurrenceDaysOfWeek[e]&&(a.weekly.sunday=!0)},t=function(){n.allDay&&(n.startTime=e(8,0,n.useLocaldate),n.endTime=e(17,30,n.useLocaldate)),l()};t();var c=function(){var e=[];i.everyDay||(a.weekly.monday&&e.push("Mon"),a.weekly.tuesday&&e.push("Tue"),a.weekly.wednesday&&e.push("Wed"),a.weekly.thursday&&e.push("Thu"),a.weekly.friday&&e.push("Fri"),a.weekly.saturday&&e.push("Sat"),a.weekly.sunday&&e.push("Sun")),n.recurrenceDaysOfWeek=e,n.everyDay=0===e.length||7===e.length};this.save=function(){n.startTime=n.allDay?null:n.startTime,n.endTime=n.allDay?null:n.endTime,c()},this.timeline=n,this.recurrence=a};return i.getTimeline=function(e,i,n,a){var l=(a||[]).length,t=!i&&!n,c=0===l||7===l,s={useLocaldate:e,always:t&&c,allDay:t,everyDay:c,startTime:i||null,endTime:n||null,recurrenceDaysOfWeek:a||[]};return s},i}]),function(e){e.module("risevision.common.components.timeline-basic").directive("timelineBasicTextbox",["$modal","TimelineBasicFactory","timelineBasicDescription",function(i,n,a){return{restrict:"E",scope:{useLocaldate:"=",timeDefined:"=",startTime:"=",endTime:"=",recurrenceDaysOfWeek:"=",latestUpdate:"=",ngDisabled:"="},templateUrl:"timeline-basic/timeline-textbox.html",link:function(l){l.$watch("latestUpdate",function(){l.timeline=n.getTimeline(l.useLocaldate,l.startTime,l.endTime,l.recurrenceDaysOfWeek),l.timeline.label=a.updateLabel(l.timeline)}),l.$watch("timeline.always",function(e){l.timeDefined=!e}),l.openModal=function(){if(!l.ngDisabled){var n=i.open({templateUrl:"timeline-basic/timeline-modal.html",controller:"timelineBasicModal",resolve:{timeline:function(){return e.copy(l.timeline)}},size:"md"});n.result.then(function(e){l.timeline=e,l.timeDefined=!(e.allDay&&e.everyDay),l.startTime=e.startTime,l.endTime=e.endTime,l.recurrenceDaysOfWeek=e.recurrenceDaysOfWeek,l.latestUpdate=Date.now(),l.timeline.label=a.updateLabel(l.timeline)},function(){})}}}}}])}(angular),function(e){e.module("risevision.common.components.timeline-basic").controller("timelineBasicModal",["$scope","$modalInstance","timeline","TimelineBasicFactory",function(e,i,n,a){var l=new a(n);e.recurrence=l.recurrence,e.timeline=l.timeline,e.today=new Date,e.save=function(){l.save(),i.close(e.timeline)},e.close=function(){i.dismiss()}}])}(angular),function(e){try{e=angular.module("risevision.common.components.timeline-basic")}catch(i){e=angular.module("risevision.common.components.timeline-basic",[])}e.run(["$templateCache",function(e){e.put("timeline-basic/timeline-modal.html",'<div id="timelineModal"><div class="modal-header"><button type="button" class="close" ng-click="close()" aria-hidden="true"><i class="fa fa-times"></i></button><h3 class="modal-title">Edit Timeline</h3></div><div class="modal-body" stop-event="touchend"><form role="form" name="timelineDetails" novalidate=""><div class="timeline"><section><label class="control-label u_margin-sm-bottom"><input type="checkbox" ng-model="timeline.allDay"> <strong>All Day</strong></label><div class="row form-group" ng-hide="timeline.allDay"><div class="col-sm-4"><label class="control-label">Start Time</label><div class="time-picker"><timepicker id="startTime" ng-model="timeline.startTime" ng-change="changed()" hour-step="1" minute-step="15" show-meridian="true" datepicker-localdate="{{timeline.useLocaldate}}"></timepicker></div></div><div class="col-sm-4"><label class="control-label">End Time</label><div class="time-picker"><timepicker id="endTime" ng-model="timeline.endTime" ng-change="changed()" hour-step="1" minute-step="15" show-meridian="true" datepicker-localdate="{{timeline.useLocaldate}}"></timepicker></div></div></div></section><section><label class="control-label u_margin-sm-bottom"><input type="checkbox" ng-model="timeline.everyDay"> <strong>Every Day</strong></label><div class="recurrence-option" ng-hide="timeline.everyDay"><div class="form-group timelineWeekdays"><label class="control-label"><input type="checkbox" ng-model="recurrence.weekly.monday"> Monday</label> <label class="control-label"><input type="checkbox" ng-model="recurrence.weekly.tuesday"> Tuesday</label> <label class="control-label"><input type="checkbox" ng-model="recurrence.weekly.wednesday"> Wednesday</label> <label class="control-label"><input type="checkbox" ng-model="recurrence.weekly.thursday"> Thursday</label> <label class="control-label"><input type="checkbox" ng-model="recurrence.weekly.friday"> Friday</label> <label class="control-label"><input type="checkbox" ng-model="recurrence.weekly.saturday"> Saturday</label> <label class="control-label"><input type="checkbox" ng-model="recurrence.weekly.sunday"> Sunday</label></div></div></section></div></form></div><div class="modal-footer"><button type="button" class="btn btn-primary btn-fixed-width" ng-click="save()" ng-disabled="timelineDetails.$invalid">Apply <i class="fa fa-white fa-check icon-right"></i></button> <button type="button" class="btn btn-default btn-fixed-width" ng-click="close()">Cancel <i class="fa fa-times icon-right"></i></button></div></div>')}])}(),function(e){try{e=angular.module("risevision.common.components.timeline-basic")}catch(i){e=angular.module("risevision.common.components.timeline-basic",[])}e.run(["$templateCache",function(e){e.put("timeline-basic/timeline-textbox.html",'<label class="control-label control-label-secondary u_margin-left"><input ng-model="timeline.always" type="checkbox" ng-disabled="ngDisabled"> Always</label><div id="timelineTextbox" class="panel-editable u_remove-bottom u_clickable" ng-class="{ \'panel-disabled\': ngDisabled }" ng-click="openModal()" ng-show="!timeline.always"><div class="label label-tag"><span id="timelineLabel" timeline="timeline">{{timeline.label}}</span></div></div>')}])}();