"use strict";angular.module("risevision.common.components.timeline-basic.services",[]),angular.module("risevision.common.components.timeline-basic",["risevision.common.components.timeline-basic.services","ui.bootstrap"]),angular.module("risevision.common.components.timeline-basic.services").factory("timelineBasicDescription",["$filter",function(e){var i={},n=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],l=function(i,n,l){var a="",t=new Date(i);return n?(t.setMinutes(t.getMinutes()+t.getTimezoneOffset()),a=e("date")(t,l)):a=e("date")(t,l),a};return i.updateLabel=function(e){var i="",a=[];if(e.allDay)i="All day ";else if(e.startTime){var t="hh:mm a";i=i+l(e.startTime,e.useLocaldate,t)+" ",e.endTime&&(i=i+"to "+l(e.endTime,e.useLocaldate,t)+" ")}if(e.recurrenceDaysOfWeek)for(var c=0;c<e.recurrenceDaysOfWeek.length;c++)"Mon"===e.recurrenceDaysOfWeek[c]?a.push(n[1]):"Tue"===e.recurrenceDaysOfWeek[c]?a.push(n[2]):"Wed"===e.recurrenceDaysOfWeek[c]?a.push(n[3]):"Thu"===e.recurrenceDaysOfWeek[c]?a.push(n[4]):"Fri"===e.recurrenceDaysOfWeek[c]?a.push(n[5]):"Sat"===e.recurrenceDaysOfWeek[c]?a.push(n[6]):"Sun"===e.recurrenceDaysOfWeek[c]&&a.push(n[0]);return e.everyDay||0===a.length||7===a.length?i+="every day":a.length>0&&(i=i+"every "+a.join(" ")),i},i}]),angular.module("risevision.common.components.timeline-basic.services").factory("TimelineBasicFactory",[function(){var e=function(e,i,n){var l=new Date;return n?l=new Date(Date.UTC(l.getFullYear(),l.getMonth(),l.getDate(),e,i,0)):(l.setHours(e),l.setMinutes(i),l.setSeconds(0),l=l.toLocaleDateString("en-US")+" "+l.toLocaleTimeString("en-US")),l},i=function(i){var n=i,l={weekly:{}},a=function(){if(n.recurrenceDaysOfWeek)for(var e=0;e<n.recurrenceDaysOfWeek.length;e++)"Mon"===n.recurrenceDaysOfWeek[e]?l.weekly.monday=!0:"Tue"===n.recurrenceDaysOfWeek[e]?l.weekly.tuesday=!0:"Wed"===n.recurrenceDaysOfWeek[e]?l.weekly.wednesday=!0:"Thu"===n.recurrenceDaysOfWeek[e]?l.weekly.thursday=!0:"Fri"===n.recurrenceDaysOfWeek[e]?l.weekly.friday=!0:"Sat"===n.recurrenceDaysOfWeek[e]?l.weekly.saturday=!0:"Sun"===n.recurrenceDaysOfWeek[e]&&(l.weekly.sunday=!0)},t=function(){n.allDay&&(n.startTime=e(8,0,n.useLocaldate),n.endTime=e(17,30,n.useLocaldate)),a()};t();var c=function(){var e=[];l.weekly.monday&&e.push("Mon"),l.weekly.tuesday&&e.push("Tue"),l.weekly.wednesday&&e.push("Wed"),l.weekly.thursday&&e.push("Thu"),l.weekly.friday&&e.push("Fri"),l.weekly.saturday&&e.push("Sat"),l.weekly.sunday&&e.push("Sun"),n.recurrenceDaysOfWeek=e,n.everyDay=0===e.length||7===e.length};this.save=function(){n.startTime=n.allDay?null:n.startTime,n.endTime=n.allDay?null:n.endTime,c()},this.timeline=n,this.recurrence=l};return i.getTimeline=function(e,i,n,l,a){var t=(a||[]).length,c=!n&&!l,s=0===t||7===t,r={useLocaldate:e,always:c&&s,allDay:c,everyDay:s,startTime:n||null,endTime:l||null,recurrenceDaysOfWeek:a||[]};return r},i}]),function(e){e.module("risevision.common.components.timeline-basic").directive("timelineBasicTextbox",["$modal","TimelineBasicFactory","timelineBasicDescription",function(i,n,l){return{restrict:"E",scope:{useLocaldate:"=",timeDefined:"=",startTime:"=",endTime:"=",recurrenceDaysOfWeek:"=",ngDisabled:"="},templateUrl:"timeline-basic/timeline-textbox.html",link:function(a){a.$watch("startTime",function(){a.timeline=n.getTimeline(a.useLocaldate,a.timeDefined,a.startTime,a.endTime,a.recurrenceDaysOfWeek),a.timeline.label=l.updateLabel(a.timeline)}),a.$watch("timeline.always",function(e){a.timeDefined=!e}),a.openModal=function(){if(!a.ngDisabled){var n=i.open({templateUrl:"timeline-basic/timeline-modal.html",controller:"timelineBasicModal",resolve:{timeline:function(){return e.copy(a.timeline)}},size:"md"});n.result.then(function(e){a.timeline=e,a.startTime=e.startTime,a.endTime=e.endTime,a.recurrenceDaysOfWeek=e.recurrenceDaysOfWeek,a.timeline.label=l.updateLabel(a.timeline)},function(){})}}}}}])}(angular),function(e){e.module("risevision.common.components.timeline-basic").controller("timelineBasicModal",["$scope","$modalInstance","timeline","TimelineBasicFactory",function(e,i,n,l){var a=new l(n);e.recurrence=a.recurrence,e.timeline=a.timeline,e.today=new Date,e.save=function(){a.save(),i.close(e.timeline)},e.close=function(){i.dismiss()}}])}(angular),function(e){try{e=angular.module("risevision.common.components.timeline-basic")}catch(i){e=angular.module("risevision.common.components.timeline-basic",[])}e.run(["$templateCache",function(e){e.put("timeline-basic/timeline-modal.html",'<div id="timelineModal"><div class="modal-header"><button type="button" class="close" ng-click="close()" aria-hidden="true"><i class="fa fa-times"></i></button><h3 class="modal-title">Edit Timeline</h3></div><div class="modal-body" stop-event="touchend"><form role="form" name="timelineDetails" novalidate=""><div class="timeline"><section><label class="control-label u_margin-sm-bottom"><input type="checkbox" ng-model="timeline.allDay"> <strong>All Day</strong></label><div class="row form-group" ng-hide="timeline.allDay"><div class="col-sm-4"><label class="control-label">Start Time</label><div class="time-picker"><timepicker id="startTime" ng-model="timeline.startTime" ng-change="changed()" hour-step="1" minute-step="15" show-meridian="true" datepicker-localdate="{{timeline.useLocaldate}}"></timepicker></div></div><div class="col-sm-4"><label class="control-label">End Time</label><div class="time-picker"><timepicker id="endTime" ng-model="timeline.endTime" ng-change="changed()" hour-step="1" minute-step="15" show-meridian="true" datepicker-localdate="{{timeline.useLocaldate}}"></timepicker></div></div></div></section><section><label class="control-label u_margin-sm-bottom"><input type="checkbox" ng-model="timeline.everyDay"> <strong>Every Day</strong></label><div class="recurrence-option" ng-hide="timeline.everyDay"><div class="form-group timelineWeekdays"><label class="control-label"><input type="checkbox" ng-model="recurrence.weekly.monday"> Monday</label> <label class="control-label"><input type="checkbox" ng-model="recurrence.weekly.tuesday"> Tuesday</label> <label class="control-label"><input type="checkbox" ng-model="recurrence.weekly.wednesday"> Wednesday</label> <label class="control-label"><input type="checkbox" ng-model="recurrence.weekly.thursday"> Thursday</label> <label class="control-label"><input type="checkbox" ng-model="recurrence.weekly.friday"> Friday</label> <label class="control-label"><input type="checkbox" ng-model="recurrence.weekly.saturday"> Saturday</label> <label class="control-label"><input type="checkbox" ng-model="recurrence.weekly.sunday"> Sunday</label></div></div></section></div></form></div><div class="modal-footer"><button type="button" class="btn btn-primary btn-fixed-width" ng-click="save()" ng-disabled="timelineDetails.$invalid">Apply <i class="fa fa-white fa-check icon-right"></i></button> <button type="button" class="btn btn-default btn-fixed-width" ng-click="close()">Cancel <i class="fa fa-times icon-right"></i></button></div></div>')}])}(),function(e){try{e=angular.module("risevision.common.components.timeline-basic")}catch(i){e=angular.module("risevision.common.components.timeline-basic",[])}e.run(["$templateCache",function(e){e.put("timeline-basic/timeline-textbox.html",'<label class="control-label control-label-secondary u_margin-left"><input ng-model="timeline.always" type="checkbox" ng-disabled="ngDisabled"> Always</label><div id="timelineTextbox" class="panel-editable u_remove-bottom u_clickable" ng-class="{ \'panel-disabled\': ngDisabled }" ng-click="openModal()" ng-show="!timeline.always"><div class="label label-tag"><span id="timelineLabel" timeline="timeline">{{timeline.label}}</span></div></div>')}])}();