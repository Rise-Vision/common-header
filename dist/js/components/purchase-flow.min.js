"use strict";angular.module("risevision.common.components.purchase-flow",["risevision.store.authorization","risevision.common.config","risevision.common.gapi","risevision.common.geodata","risevision.common.currency","risevision.common.components.loading","risevision.core.countries","ui.bootstrap"]),angular.module("risevision.common.components.purchase-flow").service("addressFactory",["$q","$log","userState","storeService","updateCompany","updateUser","addressService","contactService",function(e,t,r,a,o,n,s,i){var l={},c=function(e,t){var r={name:e.name,street:t.line1,unit:t.line2&&t.line2.length?t.line2:"",city:t.city,postalCode:t.postalCode,province:t.region,country:t.country};return s.addressesAreIdentical(e,r)};l.validateAddress=function(r){return r.validationError=!1,"CA"!==r.country&&"US"!==r.country?(t.debug("Address Validation skipped for country: ",r.country),e.resolve()):a.validateAddress(r).then(function(e){c(r,e)||t.error("Validated address differs from entered address: ",r,e)})["catch"](function(e){r.validationError=e.message?e.message:"Unknown Error"})};var d=function(e,t){if(t){var a=r.getCopyOfSelectedCompany(!0);angular.extend(a,e),r.updateCompanySettings(a)}else if(e.id===r.getUserCompanyId()){var o=r.getCopyOfUserCompany(!0);angular.extend(o,e),r.updateCompanySettings(o)}};return l.updateAddress=function(a,n,i){var l=e.defer(),c=i?s.copyAddressFromShipTo(r.getCopyOfSelectedCompany()):r.getCopyOfUserCompany(),p={},u=!1;if(!i){var m=c.billingContactEmails||[],h=n&&n.email;h&&m.indexOf(h)===-1&&(m.unshift(h),p.billingContactEmails=m,u=!0)}return a&&!s.addressesAreIdentical(a,c)||u?(i?s.copyAddressToShipTo(a,p):s.copyAddress(a,p),t.info("Company Fields changed. Saving..."),o(p.id,p).then(function(){d(p,i),t.info("Company Fields saved."),l.resolve()})["catch"](function(){t.info("Error saving Company Fields."),l.reject("Error saving Company Fields.")})):l.resolve(),l.promise},l.updateContact=function(a){var o=e.defer(),s=r.getCopyOfProfile();return a&&!i.contactsAreIdentical(a,s)?(t.info("Contact information changed. Saving..."),n(r.getUsername(),a).then(function(){var e=r.getCopyOfProfile(!0);i.copyContactObj(a,e),r.updateUserProfile(e),t.info("Contact information saved."),o.resolve()})["catch"](function(){t.info("Error saving Contact information."),o.reject("Error saving Contact information.")})):o.resolve(),o.promise},l}]),angular.module("risevision.common.components.purchase-flow").service("addressService",[function(){this.copyAddress=function(e,t){return t||(t={}),t.id=e.id,t.name=e.name,t.street=e.street,t.unit=e.unit,t.city=e.city,t.country=e.country,t.postalCode=e.postalCode,t.province=e.province,t},this.copyAddressFromShipTo=function(e,t){return t||(t={}),t.id=e.id,t.name=e.shipToName,t.street=e.shipToStreet,t.unit=e.shipToUnit,t.city=e.shipToCity,t.country=e.shipToCountry,t.postalCode=e.shipToPostalCode,t.province=e.shipToProvince,t},this.copyAddressToShipTo=function(e,t){return t||(t={}),t.id=e.id,t.shipToName=e.name,t.shipToStreet=e.street,t.shipToUnit=e.unit,t.shipToCity=e.city,t.shipToCountry=e.country,t.shipToPostalCode=e.postalCode,t.shipToProvince=e.province,t},this.addressesAreIdentical=function(e,t){return t.name===e.name&&t.street===e.street&&t.unit===e.unit&&t.city===e.city&&t.country===e.country&&t.postalCode===e.postalCode&&t.province===e.province}}]),angular.module("risevision.common.components.purchase-flow").service("contactService",[function(){this.contactsAreIdentical=function(e,t){return e.firstName===t.firstName&&e.lastName===t.lastName&&e.email===t.email&&e.telephone===t.telephone},this.copyContactObj=function(e,t){return t||(t={}),t.username=e.username,t.firstName=e.firstName,t.lastName=e.lastName,t.email=e.email,t.telephone=e.telephone,t}}]),function(e){e.module("risevision.common.components.purchase-flow").constant("RPP_ADDON_ID","c4b368be86245bf9501baaa6e0b00df9719869fd").factory("purchaseFactory",["$rootScope","$q","$log","$modal","$templateCache","$timeout","userState","storeService","stripeService","addressService","contactService","purchaseFlowTracker","RPP_ADDON_ID",function(t,r,a,o,n,s,i,l,c,d,p,u,m){var h={};h.loading=!1;var v=function(t,r){h.purchase={},h.purchase.plan=e.copy(t),h.purchase.plan.additionalDisplayLicenses=0,h.purchase.plan.isMonthly=r,h.purchase.billingAddress=d.copyAddress(i.getCopyOfUserCompany()),h.purchase.shippingAddress=d.copyAddressFromShipTo(i.getCopyOfSelectedCompany()),h.purchase.contact=p.copyContactObj(i.getCopyOfProfile()),h.purchase.paymentMethods={paymentMethod:"card",existingCreditCards:[],newCreditCard:{isNew:!0,address:{},useBillingAddress:!0,billingAddress:h.purchase.billingAddress}},h.purchase.paymentMethods.selectedCard=h.purchase.paymentMethods.newCreditCard,h.purchase.estimate={},u.trackProductAdded(h.purchase.plan)};h.showPurchaseModal=function(e,t){v(e,t);var r=o.open({template:n.get("purchase-flow/purchase-modal.html"),controller:"PurchaseModalCtrl",size:"md",backdrop:"static"});return r.result},h.showTaxExemptionModal=function(){var e=o.open({template:n.get("purchase-flow/tax-exemption.html"),controller:"TaxExemptionModalCtrl",size:"md",backdrop:"static"});return e.result};var f=function(e,t){return e.validationErrors=c.validateCard(e,t),!(!e.validationErrors||e.validationErrors.length>0)};h.validatePaymentMethod=function(){var e=h.purchase.paymentMethods,t=r.defer();if("invoice"===e.paymentMethod)t.resolve();else if("card"===e.paymentMethod)if(e.selectedCard.isNew){if(f(e.newCreditCard,!0)){var a=e.newCreditCard.address;return e.newCreditCard.useBillingAddress&&(a=e.newCreditCard.billingAddress),h.loading=!0,c.createToken(e.newCreditCard,a).then(function(t){e.newCreditCard.id=t.id,e.newCreditCard.last4=t.card.last4,e.newCreditCard.cardType=t.card.type})["finally"](function(){h.loading=!1})}t.reject()}else f(e.selectedCard,!1)?t.resolve():t.reject();return t.promise};var g=function(){return h.purchase.plan.isMonthly?"01m":"01y"},b=function(){return"CA"===h.purchase.billingAddress.country?"cad":"usd"},y=function(){return h.purchase.plan.productCode+"-"+b()+g()},x=function(){return m+"-"+b()+g()+h.purchase.plan.productCode.substring(0,3)};h.getEstimate=function(){return h.purchase.estimate={currency:b()},h.loading=!0,l.calculateTaxes(h.purchase.billingAddress.id,y(),x(),h.purchase.plan.additionalDisplayLicenses,h.purchase.shippingAddress).then(function(e){var t=h.purchase.estimate;t.taxesCalculated=!0,t.taxes=e.taxes||[],t.total=e.total,t.totalTax=e.totalTax,t.shippingTotal=e.shippingTotal,u.trackPlaceOrderClicked(t)})["catch"](function(e){h.purchase.estimate.estimateError=e&&e.error||"An unexpected error has occurred. Please try again."})["finally"](function(){h.loading=!1})};var C=function(){var e=[{id:y()},{id:x(),qty:h.purchase.plan.additionalDisplayLicenses}],t=h.purchase.paymentMethods.selectedCard,r=h.purchase.paymentMethods.isOnAccount?null:{cardId:t.id,isDefault:!!t.isDefault},a={billTo:d.copyAddress(h.purchase.billingAddress),shipTo:d.copyAddress(h.purchase.shippingAddress),items:e,purchaseOrderNumber:h.purchase.paymentMethods.purchaseOrderNumber,card:r};return JSON.stringify(a)};return h.completePayment=function(){var e=C();return h.purchase.checkoutError=null,h.loading=!0,l.purchase(e).then(function(){h.purchase.reloadingCompany=!0,u.trackOrderPayNowClicked(h.purchase.estimate),s(1e4).then(function(){return i.reloadSelectedCompany()}).then(function(){t.$emit("risevision.company.trial.started")})["catch"](function(e){a.debug("Failed to reload company",e)})["finally"](function(){h.purchase.reloadingCompany=!1})})["catch"](function(e){h.purchase.checkoutError=e&&e.message?e.message:"There was an unknown error with the payment."})["finally"](function(){h.loading=!1})},h}])}(angular),angular.module("risevision.common.components.purchase-flow").factory("stripeLoader",["$q","$interval","$window","userState","STRIPE_PROD_KEY","STRIPE_TEST_KEY",function(e,t,r,a,o,n){var s=e.defer(),i=setInterval(function(){r.Stripe&&(t.cancel(i),s.resolve(r.Stripe))},50);return function(){return s.promise.then(function(e){var t=a.getCopyOfUserCompany().isTest;return e.setPublishableKey(t?n:o),e})}}]),angular.module("risevision.common.components.purchase-flow").constant("STRIPE_ERRORS",{invalid_number:"Invalid Card Number.",incorrect_number:"Invalid Card Number.",invalid_cvc:"Invalid Security Code.",incorrect_cvc:"Invalid Security Code.",invalid_expiry_month:"Invalid Exp. Month.",invalid_expiry_year:"Invalid Exp. Year.",incorrect_zip:"Invalid ZIP / Postal Code. The ZIP / Postal Code provided is not associated with the billing address of this card.",expired_card:"The card provided has expired.",card_declined:"The card was declined. Please confirm all information is correct. If the problem continues try a different card.",missing:"No card associated with the account.",processing_error:"An unexpected error has occurred. Please try again."}).service("stripeService",["$q","$log","$window","stripeLoader","STRIPE_ERRORS",function(e,t,r,a,o){this.validateCard=function(e,t){var a=[];return r.Stripe?(t&&(e.number=e.number?e.number.trim():"",r.Stripe.card.validateCardNumber(e.number)||a.push(o.invalid_number),r.Stripe.card.validateCVC(e.cvc)||a.push(o.invalid_cvc)),r.Stripe.card.validateExpiry(e.expMonth,e.expYear)||a.push("Invalid Expiry Date."),a):(a.push(o.processing_error),a)};var n=function(e){var t=o[e];return t||(t=o.processing_error),t};this.createToken=function(r,o){var s=e.defer();r.tokenError=null;var i={number:r.number,cvc:r.cvc,exp_month:r.expMonth,exp_year:r.expYear,name:r.name,address_line1:o.street,address_line2:o.unit,address_city:o.city,address_state:o.province,address_zip:o.postalCode,address_country:o.country};return a().then(function(e){e.card.createToken(i,function(e,a){a&&a.card&&!a.error?(t.debug("Create Token response: ",a),s.resolve(a)):(console.error("Failed to get Card Token: ",a),r.tokenError=n(a&&a.error&&a.error.code),s.reject())})}),s.promise}}]),angular.module("risevision.common.components.purchase-flow").factory("purchaseFlowTracker",["segmentAnalytics",function(e){var t={};return t.trackProductAdded=function(t){e.track("Product Added",{id:t.productCode,name:t.name,price:t.isMonthly?t.monthly.billAmount:t.yearly.billAmount,quantity:1,category:"Plans",inApp:!1})},t.trackPlaceOrderClicked=function(t){e.track("Place Order Clicked",{amount:t.total,currency:t.currency,inApp:!1})},t.trackOrderPayNowClicked=function(t){e.track("Order Pay Now Clicked",{amount:t.total,currency:t.currency,inApp:!1})},t}]),angular.module("risevision.common.components.purchase-flow").directive("addressForm",["$templateCache","COUNTRIES","REGIONS_CA","REGIONS_US",function(e,t,r,a){return{restrict:"E",scope:{formObject:"=",addressObject:"=",hideCompanyName:"="},template:e.get("purchase-flow/address-form.html"),link:function(e){e.countries=t,e.regionsCA=r,e.regionsUS=a,e.isFieldInvalid=function(t){var r=e.formObject,a=r[t];return(a.$dirty||r.$submitted)&&a.$invalid}}}}]),angular.module("risevision.common.components.purchase-flow").directive("billingAddress",["$templateCache","purchaseFactory",function(e,t){return{restrict:"E",template:e.get("purchase-flow/checkout-billing-address.html"),link:function(e){e.billingAddress=t.purchase.billingAddress,e.contact=t.purchase.contact}}}]),angular.module("risevision.common.components.purchase-flow").directive("checkoutSuccess",["$templateCache",function(e){return{restrict:"E",template:e.get("purchase-flow/checkout-success.html"),link:function(){}}}]),angular.module("risevision.common.components.purchase-flow").directive("paymentMethods",["$templateCache","purchaseFactory",function(e,t){return{restrict:"E",template:e.get("purchase-flow/checkout-payment-methods.html"),link:function(e){e.paymentMethods=t.purchase.paymentMethods,e.getCardDescription=function(e){return"***-"+e.last4+", "+e.cardType+(e.isDefault?" (default)":"")}}}}]),angular.module("risevision.common.components.purchase-flow").directive("provinceValidator",["REGIONS_CA","REGIONS_US",function(e,t){return{require:"ngModel",restrict:"A",scope:{provinceValidator:"="},link:function(r,a,o,n){var s=function(a){var o=r.provinceValidator,s=!0;return o&&("CA"===o?s=a&&_.find(e,function(e){return e[1]===a}):"US"===o&&(s=a&&_.find(t,function(e){return e[1]===a}))),n.$setValidity("validProvince",!!s),a};r.$watch("provinceValidator",function(){s(n.$modelValue)}),n.$parsers.unshift(s),n.$formatters.unshift(s)}}}]),angular.module("risevision.common.components.purchase-flow").directive("reviewPurchase",["$templateCache","userState","purchaseFactory",function(e,t,r){return{restrict:"E",template:e.get("purchase-flow/checkout-review-purchase.html"),link:function(e){e.purchase=r.purchase,e.selectedCompany=t.getCopyOfSelectedCompany(),e.getPlanPrice=function(){var t=e.purchase.plan;return t.isMonthly?t.monthly.billAmount:t.yearly.billAmount},e.getAdditionalDisplaysPrice=function(){var t=e.purchase.plan;return t.isMonthly?t.additionalDisplayLicenses*t.monthly.priceDisplayMonth:t.additionalDisplayLicenses*t.yearly.priceDisplayYear},e.showTaxExemptionModal=function(){r.showTaxExemptionModal()}}}}]),angular.module("risevision.common.components.purchase-flow").directive("reviewSubscription",["$templateCache","purchaseFactory",function(e,t){return{restrict:"E",template:e.get("purchase-flow/checkout-review-subscription.html"),link:function(e){e.plan=t.purchase.plan;var r=function(){var t=e.plan.additionalDisplayLicenses;return!isNaN(t)&&t%1===0&&t>=0?t:0};e.incrementLicenses=function(){e.plan.additionalDisplayLicenses=r()+1},e.decrementLicenses=function(){0===r()&&(e.plan.additionalDisplayLicenses=0),e.plan.additionalDisplayLicenses>0&&e.plan.additionalDisplayLicenses--},e.getMonthlyPrice=function(){return e.plan.monthly.billAmount+r()*e.plan.monthly.priceDisplayMonth},e.getYearlyPrice=function(){return e.plan.yearly.billAmount+r()*e.plan.yearly.priceDisplayYear}}}}]),angular.module("risevision.common.components.purchase-flow").directive("shippingAddress",["$templateCache","purchaseFactory",function(e,t){return{restrict:"E",template:e.get("purchase-flow/checkout-shipping-address.html"),link:function(e){e.shippingAddress=t.purchase.shippingAddress}}}]),angular.module("risevision.common.components.purchase-flow").directive("yearSelector",["$templateCache",function(e){return{restrict:"E",template:e.get("purchase-flow/year-selector.html"),replace:"true",scope:{ngModel:"=?"},controller:["$scope",function(e){var t=(new Date).getFullYear(),r=20;e.init=function(){e.years=[],e.ngModel&&e.ngModel<t&&e.years.push(e.ngModel.toString());for(var a=0;a<r;a++)e.years.push((t+a).toString())},e.init()}]}}]),angular.module("risevision.common.components.purchase-flow").value("PURCHASE_STEPS",[{name:"Subscription Details",index:0,formName:"reviewSubscriptionForm"},{name:"Billing Address",index:1,formName:"billingAddressForm"},{name:"Shipping Address",index:2,formName:"shippingAddressForm"},{name:"Payment Method",index:3,formName:"paymentMethodsForm"},{name:"Purchase Review",index:4}]).controller("PurchaseModalCtrl",["$scope","$modalInstance","$loading","purchaseFactory","addressFactory","PURCHASE_STEPS",function(e,t,r,a,o,n){e.form={},e.factory=a,e.PURCHASE_STEPS=n,e.currentStep=4,e.finalStep=!1,e.$watch("factory.loading",function(e){e?r.start("purchase-modal"):r.stop("purchase-modal")});var s=function(){var t=n[e.currentStep],r=t.formName,a=e.form[r];return!a||a.$valid};e.validateAddress=function(t,r,n){s()&&(a.loading=!0,o.validateAddress(t)["finally"](function(){a.loading=!1,t.validationError||(o.updateContact(r),o.updateAddress(t,r,n),e.setNextStep())}))},e.validatePaymentMethod=function(){s()&&a.validatePaymentMethod().then(e.setNextStep)},e.completePayment=function(){a.completePayment().then(function(){a.purchase.checkoutError||e.setNextStep()})},e.setNextStep=function(){s()&&(e.finalStep&&e.currentStep<3||3===e.currentStep?(e.currentStep=4,e.finalStep=!0,a.getEstimate()):e.currentStep++)},e.setPreviousStep=function(){e.currentStep>0&&e.currentStep--},e.setCurrentStep=function(t){a.purchase.checkoutError=null,e.currentStep=t},e.close=function(){a.purchase.reloadingCompany?(a.loading=!0,e.$watch("factory.purchase.reloadingCompany",function(e){e||(a.loading=!1,t.close("success"))})):t.close("success")},e.dismiss=function(){t.dismiss("cancel")}}]),angular.module("risevision.common.components.purchase-flow").controller("TaxExemptionModalCtrl",["$scope","$modalInstance","$loading","$filter","storeService","COUNTRIES","REGIONS_CA","REGIONS_US",function(e,t,r,a,o,n,s,i){e.formData={},e.countries=n,e.regionsCA=s,e.regionsUS=i,e.taxExemptionSubmitted=!1,e.submit=function(){if(e.taxExemptionSubmitted=!1,e.errors=e.validate(),!e.errors.length){var t=new FormData;t.append("file",e.formData.file),r.start("tax-modal"),o.uploadTaxExemptionCertificate(t).then(function(t){var r=a("date")(e.formData.expiryDate,"yyyy-MM-dd");return o.addTaxExemption(e.formData.country,e.formData.province,t,e.formData.number,r)}).then(function(){e.taxExemptionSubmitted=!0})["catch"](function(t){e.errors.push(t.message?t.message:"An error ocurred while submitting your tax exemption. Please try again.")})["finally"](function(){r.stop("tax-modal")})}},e.close=function(){t.close()},e.validate=function(){var t=[];return e.formData.file||t.push("Missing Exemption Document"),e.formData.number||t.push("Missing Exemption Number"),e.formData.country||t.push("Missing Exempt in Country"),e.formData.province||t.push("Missing Exempt in State"),t},e.selectFile=function(){setTimeout(function(){document.querySelector("#inputExemption").click()},0)},e.setFile=function(t){e.$apply(function(){e.fileNotSelected=!0,e.formData.file=t.files[0]})},e.clearFile=function(){e.fileNotSelected=!1,e.formData.file=null,document.querySelector("#inputExemption").value=""},e.openDatepicker=function(t){t.preventDefault(),t.stopPropagation(),e.datepicker=!0},e.countryFilter=function(e){return"CA"===e.code||"US"===e.code}}]),angular.module("risevision.common.components.purchase-flow").filter("cardLastFour",[function(){return function(e){return e=e?e:"****",e=e.length<4?"****".substr(e.length)+e:e,e=e.length>4?e.substr(e.length-4):e,"***-"+e}}]),angular.module("risevision.common.components.purchase-flow").filter("countryName",["COUNTRIES",function(e){return function(t){for(var r=t,a=0;a<e.length;a++)if(e[a].code===t){r=e[a].name;break}return r}}]),angular.module("risevision.common.components.purchase-flow").filter("paddedMonth",[function(){return function(e){return e<10&&(e="0"+e),e}}]),function(e){try{e=angular.module("risevision.common.components.purchase-flow")}catch(t){e=angular.module("risevision.common.components.purchase-flow",[])}e.run(["$templateCache",function(e){e.put("purchase-flow/address-form.html",'<div class="form-group" ng-if="hideCompanyName !== true" ng-class="{ \'has-error\': isFieldInvalid(\'companyName\') }"><label for="address-form-companyName" class="control-label">Company Name *</label> <input id="address-form-companyName" name="companyName" type="text" class="form-control" ng-model="addressObject.name" autocomplete="organization" aria-required="true" tabindex="1" required=""></div><div class="row"><div class="col-md-6"><div class="form-group" ng-class="{ \'has-error\': isFieldInvalid(\'street\') }"><label for="address-form-streetAddress" class="control-label">Street Address *</label> <input id="address-form-streetAddress" name="street" type="text" class="form-control" ng-model="addressObject.street" autocomplete="address-line1" pattern=".{0,50}" aria-required="true" tabindex="1" required=""></div></div><div class="col-md-6"><div class="form-group"><label for="address-form-unit" class="control-label">Unit</label> <input id="address-form-unit" type="text" name="unit" class="form-control" ng-model="addressObject.unit" autocomplete="address-line2" aria-required="true" tabindex="1" pattern=".{0,100}"></div></div></div><div class="row"><div class="col-md-6"><div class="form-group" ng-class="{ \'has-error\': isFieldInvalid(\'city\') }"><label for="address-form-city" class="control-label">City *</label> <input id="address-form-city" name="city" type="text" class="form-control" ng-model="addressObject.city" autocomplete="address-level2" aria-required="true" tabindex="1" required=""></div></div><div class="col-md-6"><div class="form-group" ng-class="{ \'has-error\': isFieldInvalid(\'country\') }"><label for="address-form-country" class="control-label">Country *</label><select id="address-form-country" name="country" autocomplete="country" class="form-control" ng-model="addressObject.country" ng-options="c.code as c.name for c in countries" empty-select-parser="" aria-required="true" tabindex="1" required=""><option ng-show="false" value="">&lt; Select Country &gt;</option></select></div></div></div><div class="row"><div class="col-md-6"><div class="form-group" ng-class="{ \'has-error\': isFieldInvalid(\'province\') }"><label class="control-label">State/Province/Region <span ng-hide="addressObject.country !== \'US\' && addressObject.country !== \'CA\'">*</span></label> <label for="province" class="hidden">Enter Province or Region</label> <input name="province" type="text" class="form-control" ng-model="addressObject.province" autocomplete="address-level1" ng-show="addressObject.country !== \'US\' && addressObject.country !== \'CA\'" province-validator="addressObject.country" tabindex="1"> <label for="province-selector" class="hidden">Select Province (Canada)</label><select name="province-selector" class="form-control selectpicker" ng-model="addressObject.province" ng-options="c[1] as c[0] for c in regionsCA" autocomplete="address-level1" ng-show="addressObject.country === \'CA\'" empty-select-parser="" tabindex="1"><option ng-show="false" value="">&lt; Select Province &gt;</option></select><label for="state-selector" class="hidden">Select State (United States)</label><select name="state-selector" class="form-control selectpicker" ng-model="addressObject.province" ng-options="c[1] as c[0] for c in regionsUS" autocomplete="address-level1" ng-show="addressObject.country === \'US\'" empty-select-parser="" tabindex="1"><option ng-show="false" value="">&lt; Select State &gt;</option></select></div></div><div class="col-md-6"><div class="form-group" ng-class="{ \'has-error\': isFieldInvalid(\'postalCode\') }"><label for="address-form-postalCode" class="control-label">ZIP/Postal Code *</label> <input id="address-form-postalCode" name="postalCode" type="text" class="form-control" ng-model="addressObject.postalCode" autocomplete="postal-code" pattern=".{0,11}" aria-required="true" tabindex="1" required=""></div></div></div>')}])}(),function(e){try{e=angular.module("risevision.common.components.purchase-flow")}catch(t){e=angular.module("risevision.common.components.purchase-flow",[])}e.run(["$templateCache",function(e){e.put("purchase-flow/checkout-billing-address.html",'<div id="checkout-billing-address" class="address-editor"><form id="form.billingAddressForm" role="form" class="u_margin-md-top" name="form.billingAddressForm" autocomplete="on" novalidate=""><div class="alert alert-danger" ng-show="form.billingAddressForm.$submitted && form.billingAddressForm.$invalid">Please complete the missing information below.</div><div id="errorBox" class="alert alert-danger" role="alert" ng-show="billingAddress.validationError"><strong>Address Validation Error</strong> {{billingAddress.validationError}}</div><div class="row"><div class="col-md-6"><div class="form-group" ng-class="{ \'has-error\': (form.billingAddressForm.firstName.$dirty || form.billingAddressForm.$submitted) && form.billingAddressForm.firstName.$invalid }"><label for="contact-firstName" class="control-label">First Name *</label> <input id="contact-firstName" type="text" class="form-control" name="firstName" ng-model="contact.firstName" autocomplete="given-name" aria-required="true" tabindex="1" required=""></div></div><div class="col-md-6"><div class="form-group" ng-class="{ \'has-error\': (form.billingAddressForm.lastName.$dirty || form.billingAddressForm.$submitted) && form.billingAddressForm.lastName.$invalid }"><label for="contact-lastName" class="control-label">Last Name *</label> <input id="contact-lastName" type="text" class="form-control" name="lastName" ng-model="contact.lastName" autocomplete="family-name" aria-required="true" tabindex="1" required=""></div></div></div><div class="row"><div class="col-md-6"><div class="form-group" ng-class="{ \'has-error\': (form.billingAddressForm.email.$dirty || form.billingAddressForm.$submitted) && form.billingAddressForm.email.$invalid }"><label for="contact-email" class="control-label">Email *</label> <input id="contact-email" type="email" class="form-control" name="email" ng-model="contact.email" autocomplete="email" aria-required="true" tabindex="1" required=""></div></div><div class="col-md-6"><div class="form-group"><label for="contact-phone" class="control-label">Telephone</label> <input id="contact-phone" name="tel" type="tel" class="form-control" ng-model="contact.telephone" autocomplete="tel" tabindex="1"></div></div></div><address-form form-object="form.billingAddressForm" address-object="billingAddress"></address-form><hr><div class="row"><div class="col-xs-12"><button id="backButton" type="button" class="btn btn-default pull-left" ng-click="setPreviousStep()" ng-hide="finalStep" aria-label="Go back to Subscription Details" translate="" tabindex="2">common.back</button> <button id="continueButton" aria-label="Continue to Shipping Address" type="submit" form="form.billingAddressForm" class="btn btn-primary pull-right" ng-click="validateAddress(billingAddress, contact, false)" translate="" tabindex="1">common.continue</button></div></div></form></div>')}])}(),function(e){try{e=angular.module("risevision.common.components.purchase-flow")}catch(t){e=angular.module("risevision.common.components.purchase-flow",[])}e.run(["$templateCache",function(e){e.put("purchase-flow/checkout-payment-methods.html",'<div id="checkout-payment-methods"><form id="form.paymentMethodsForm" role="form" class="u_margin-md-top" name="form.paymentMethodsForm" novalidate=""><div class="row u_margin-md-top" ng-if="false"><div class="col-md-8 col-xs-12 form-inline"><div class="form-group"><label for="payment-method-select" class="u_margin-right">Payment Method</label><select id="payment-method-select" class="form-control selectpicker" ng-model="paymentMethods.paymentMethod" tabindex="1"><option value="card">Credit Card</option><option value="invoice">Invoice Me</option></select></div></div></div><hr ng-if="false"><div id="credit-card-form" ng-if="paymentMethods.paymentMethod === \'card\'"><div class="row" ng-if="false"><div class="col-md-12"><div class="form-group"><label for="credit-card-select" class="hidden">Add New Credit Card</label><select id="credit-card-select" class="form-control selectpicker" ng-model="paymentMethods.selectedCard" ng-options="c as getCardDescription(c) for c in paymentMethods.existingCreditCards track by c.id"><option value="">Add New Credit Card</option></select></div></div></div><div id="new-credit-card-form" ng-if="paymentMethods.selectedCard.isNew"><div class="alert alert-danger" ng-show="form.paymentMethodsForm.$submitted && form.paymentMethodsForm.$invalid">Please complete the missing information below.</div><div id="errorBox" class="alert alert-danger" role="alert" ng-show="paymentMethods.newCreditCard.validationErrors.length"><strong>Card Validation Error<span ng-show="paymentMethods.newCreditCard.validationErrors.length > 1">s</span></strong><ul><li ng-repeat="error in paymentMethods.newCreditCard.validationErrors">{{error}}</li></ul></div><div id="errorBox" class="alert alert-danger" role="alert" ng-show="paymentMethods.newCreditCard.tokenError"><strong>Card Processing Error</strong> {{paymentMethods.newCreditCard.tokenError}}</div><div class="row"><div class="col-md-12"><div class="form-group" ng-class="{ \'has-error\': (form.paymentMethodsForm.cardholderName.$dirty || form.paymentMethodsForm.$submitted) && form.paymentMethodsForm.cardholderName.$invalid }"><label for="new-card-name" lass="control-label">Cardholder Name *</label> <input id="new-card-name" aria-required="true" tabindex="1" type="text" class="form-control" name="cardholderName" data-stripe="name" ng-model="paymentMethods.newCreditCard.name" autocomplete="cc-name" required=""></div></div></div><div class="row"><div class="col-md-12"><div class="form-group" ng-class="{ \'has-error\': (form.paymentMethodsForm.cardNumber.$dirty || form.paymentMethodsForm.$submitted) && form.paymentMethodsForm.cardNumber.$invalid }"><label for="new-card-number" class="control-label">Card Number *</label> <input id="new-card-number" type="text" aria-required="true" tabindex="1" class="form-control" placeholder="0000 0000 0000 0000" name="cardNumber" data-stripe="number" ng-model="paymentMethods.newCreditCard.number" autocomplete="cc-number" required=""></div></div></div><div class="row"><div class="col-md-4"><div class="form-group" ng-class="{ \'has-error\': (form.paymentMethodsForm.cardExpiryMonth.$dirty || form.paymentMethodsForm.$submitted) && form.paymentMethodsForm.cardExpiryMonth.$invalid }"><label for="new-card-expiry-month" class="control-label">Expiry Month *</label><select id="new-card-expiry-month" aria-required="true" tabindex="1" class="form-control" name="cardExpiryMonth" data-stripe="exp-month" ng-model="paymentMethods.newCreditCard.expMonth" autocomplete="cc-exp-month" integer-parser="" required=""><option ng-show="false" value="">&lt; Select Month &gt;</option><option value="1">01</option><option value="2">02</option><option value="3">03</option><option value="4">04</option><option value="5">05</option><option value="6">06</option><option value="7">07</option><option value="8">08</option><option value="9">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option></select></div></div><div class="col-md-4"><div class="form-group" ng-class="{ \'has-error\': (form.paymentMethodsForm.cardExpiryYear.$dirty || form.paymentMethodsForm.$submitted) && form.paymentMethodsForm.cardExpiryYear.$invalid }"><label for="expiry-year" class="control-label">Expiry Year *</label><year-selector id="new-card-expiry-year" class="form-control" name="cardExpiryYear" data-stripe="exp-year" ng-model="paymentMethods.newCreditCard.expYear" tabindex="1" autocomplete="cc-exp-year" integer-parser="" required=""></year-selector></div></div><div class="col-md-4"><div class="form-group" ng-class="{ \'has-error\': (form.paymentMethodsForm.cardCvc.$dirty || form.paymentMethodsForm.$submitted) && form.paymentMethodsForm.cardCvc.$invalid }"><label for="new-card-cvc" class="control-label">Security Code *</label> <input id="new-card-cvc" aria-required="true" tabindex="1" type="number" class="form-control" name="cardCvc" data-stripe="cvc" ng-model="paymentMethods.newCreditCard.cvc" autocomplete="cc-csc" maxlength="4" required=""></div></div></div><div class="checkbox"><label for="toggleMatchBillingAddress" aria-label="Match Billing Address"><input type="checkbox" id="toggleMatchBillingAddress" ng-model="paymentMethods.newCreditCard.useBillingAddress" tabindex="1"> Same As Billing Address</label></div><div id="new-card-address"><address-form form-object="form.paymentMethodsForm" address-object="paymentMethods.newCreditCard.address" hide-company-name="true" ng-if="!paymentMethods.newCreditCard.useBillingAddress"></address-form></div></div><div id="existing-credit-card-form" ng-if="!paymentMethods.selectedCard.isNew"><div id="errorBox" class="alert alert-danger" role="alert" ng-show="paymentMethods.selectedCard.validationErrors.length"><strong>Card Validation Error</strong> {{paymentMethods.selectedCard.validationErrors[0]}}</div><div class="row"><div class="col-md-12"><div class="form-group"><label for="existing-card-name" class="control-label">Cardholder Name</label> <input id="existing-card-name" type="text" class="form-control" placeholder="{{paymentMethods.selectedCard.name}}" tabindex="1" disabled="disabled"></div></div></div><div class="row"><div class="col-md-12"><div class="form-group"><label for="existing-card-number" class="control-label">Card Number</label> <input id="existing-card-number" type="text" class="form-control" placeholder="{{paymentMethods.selectedCard.last4 | cardLastFour}}" tabindex="1" disabled="disabled"></div></div></div><div class="row form-group"><div class="col-md-4"><div class="form-group"><label for="existing-card-expiry-month" class="control-label">Expiry Month</label> <input id="existing-card-expiry-month" type="text" class="form-control masked" placeholder="{{paymentMethods.selectedCard.expMonth | paddedMonth}}" disabled="disabled" tabindex="1"></div></div><div class="col-md-4"><div class="form-group"><label for="existing-card-expiry-year" class="control-label">Expiry Year</label> <input id="existing-card-expiry-year" type="text" class="form-control masked" placeholder="{{paymentMethods.selectedCard.expYear}}" tabindex="1" disabled="disabled"></div></div></div></div></div><div id="generateInvoice" ng-if="paymentMethods.paymentMethod === \'invoice\'"><p>If you\'d like to be invoiced for your purchase (rather than paying now by credit card), please enter a <b>Purchase Order</b> number and continue with checkout.</p><p>You will receive an invoice for this purchase total at <b>user@domain.com</b>. Invoices are due within 30 days of creation, payable by check, wire transfer, or credit card.</p><p>Please note your invoice is generated only once this checkout is completed.</p><div class="row"><div class="col-xs-12 col-sm-6"><div class="form-group"><label class="control-label" id="triggerOverdue">Purchase Order Number</label> <input type="text" class="form-control"></div></div></div><div id="generateInvoiceOverdue" style="display:none"><p class="text-danger">You have overdue invoice payments on your account.</p><p>In order to complete this purchase by invoice, please pay your outstanding invoices <a href="#">here</a>.</p></div></div><hr><div class="row"><div class="col-xs-12"><button id="backButton" type="button" aria-label="Go back to Shipping Address" class="btn btn-default pull-left" ng-click="setPreviousStep()" ng-hide="finalStep" tabindex="2" translate="">common.back</button> <button id="continueButton" type="submit" aria-label="Continue to Purchase Review" form="form.paymentMethodsForm" class="btn btn-primary pull-right" ng-click="validatePaymentMethod()" tabindex="1" translate="">common.continue</button></div></div></form></div>');
}])}(),function(e){try{e=angular.module("risevision.common.components.purchase-flow")}catch(t){e=angular.module("risevision.common.components.purchase-flow",[])}e.run(["$templateCache",function(e){e.put("purchase-flow/checkout-review-purchase.html",'<div id="checkout-review-purchase"><div id="errorBox" class="alert alert-danger" role="alert" ng-show="purchase.estimate.estimateError"><div class="row"><div class="col-xs-9"><p><strong>Tax Estimate Error</strong> {{purchase.estimate.estimateError}}</p></div><div class="col-xs-3"><a class="btn btn-default btn-block" href="#" ng-click="factory.getEstimate()">Retry</a></div></div></div><div id="errorBox" class="alert alert-danger" role="alert" ng-show="purchase.checkoutError"><strong>Payment Error</strong> {{purchase.checkoutError}}</div><div class="row"><div class="col-md-6 u_margin-sm-top"><h4 class="u_margin-sm-bottom">Purchasing For</h4><span class="font-weight-bold">{{selectedCompany.name}}</span><br>Company ID: {{selectedCompany.id}}</div><div class="col-md-6 u_margin-sm-top"><h4 class="u_margin-sm-bottom">Payment Method <button aria-label="Edit Payment Method" class="btn btn-default btn-xs" ng-click="setCurrentStep(3)" tabindex="1">Edit</button></h4><span class="font-weight-bold">{{purchase.paymentMethods.selectedCard.cardType}}</span><br>{{purchase.paymentMethods.selectedCard.last4 | cardLastFour}}<br>Exp: {{purchase.paymentMethods.selectedCard.expMonth | paddedMonth}}/{{purchase.paymentMethods.selectedCard.expYear}}</div></div><div class="row"><div class="col-md-6 u_margin-sm-top"><h4 class="u_margin-sm-bottom">Billing Address <button aria-label="Edit Billing Address" class="btn btn-default btn-xs" ng-click="setCurrentStep(1)" tabindex="1">Edit</button></h4>{{purchase.contact.firstName}} {{purchase.contact.lastName}}<br>{{purchase.contact.email}}<br>{{purchase.billingAddress.name}}<br>{{purchase.billingAddress.street}}<br><span ng-show="purchase.billingAddress.unit">{{purchase.billingAddress.unit}}</span> {{purchase.billingAddress.city}}, <span ng-show="purchase.billingAddress.province">{{purchase.billingAddress.province}},</span> {{purchase.billingAddress.postalCode}}<br>{{purchase.billingAddress.country | countryName}}</div><div class="col-md-6 u_margin-sm-top"><h4 class="u_margin-sm-bottom">Shipping Address <button aria-label="Edit Shipping Address" class="btn btn-default btn-xs" ng-click="setCurrentStep(2)" tabindex="1">Edit</button></h4>{{purchase.shippingAddress.name}}<br>{{purchase.shippingAddress.street}}<br><span ng-show="purchase.shippingAddress.unit">{{purchase.shippingAddress.unit}}</span> {{purchase.shippingAddress.city}}, <span ng-show="purchase.shippingAddress.province">{{purchase.shippingAddress.province}},</span> {{purchase.shippingAddress.postalCode}}<br>{{purchase.shippingAddress.country | countryName}}</div></div><br><hr class="u_margin-xs-top u_margin-xs-bottom"><div class="row"><div class="col-xs-12"><h4 class="u_margin-sm-bottom">Subscription Details <button aria-label="Edit Subscription Details" class="btn btn-default btn-xs" ng-click="setCurrentStep(0)" tabindex="1">Edit</button></h4></div></div><div class="row"><div class="col-sm-4 col-xs-6 text-right"><p>{{purchase.plan.name}} ({{ purchase.plan.isMonthly ? \'Monthly\' : \'Yearly\' }})<br><span ng-show="purchase.plan.additionalDisplayLicenses">{{purchase.plan.additionalDisplayLicenses}} Additional Display<span ng-show="purchase.plan.additionalDisplayLicenses > 1">s</span><br></span> <span ng-repeat="tax in purchase.estimate.taxes">{{tax.taxName}}<br></span> Total Tax:</p><span class="order-total">Order Total:</span></div><div class="col-sm-4 col-xs-6 text-right"><p>${{getPlanPrice()}}<br><span ng-show="purchase.plan.additionalDisplayLicenses">${{getAdditionalDisplaysPrice()}}<br></span> <span ng-repeat="tax in purchase.estimate.taxes">${{tax.taxAmount | number:2}}<br></span> ${{purchase.estimate.totalTax | number:2}}</p><span class="order-total">${{purchase.estimate.total | number:2}} <span class="u_margin-left text-subtle">{{purchase.estimate.currency | uppercase}}</span></span></div><div class="col-sm-4 col-xs-12 text-right"><button id="showTaxExemption" ng-click="showTaxExemptionModal()" class="btn btn-default btn-xs">Submit Tax Exemption</button></div></div><div class="row"><hr class="u_margin-sm-top"></div><div class="row"><div class="col-xs-8 col-xs-offset-2 u_margin-md-bottom"><button id="payButton" class="btn btn-primary btn-hg btn-block" ng-click="completePayment()" tabindex="1" aria-label="Complete Payment"><span id="payLabel">Pay ${{purchase.estimate.total | number:2}} Now</span></button></div></div></div>')}])}(),function(e){try{e=angular.module("risevision.common.components.purchase-flow")}catch(t){e=angular.module("risevision.common.components.purchase-flow",[])}e.run(["$templateCache",function(e){e.put("purchase-flow/checkout-review-subscription.html",'<div id="checkout-review-subscription"><form id="reviewSubscriptionForm" role="form" name="form.reviewSubscriptionForm" autocomplete="on" novalidate=""><h3 class="text-center" translate="" translate-values="{ planName: plan.name }">common-header.purchase.review-subscription.plan-name</h3><div class="subscription-summary text-center"><div class="subscription-summary-item"><div class="stat"><div class="stat-value">${{plan.monthly.priceDisplayMonth}}</div><div class="stat-legend">{{ \'common-header.purchase.review-subscription.per-display\' | translate}} {{ \'common-header.purchase.review-subscription.per-month\' | translate}}</div></div></div><div class="subscription-summary-divider">x</div><div class="subscription-summary-item"><div class="stat"><div class="stat-value">{{plan.proLicenseCount}}</div><div class="stat-legend"><span ng-show="plan.proLicenseCount === 1" translate="">common-header.purchase.review-subscription.display-included</span> <span ng-show="plan.proLicenseCount > 1" translate="">common-header.purchase.review-subscription.displays-included</span></div></div></div></div><hr class="u_remove-margin"><div class="text-center flex-additive-rule"><b>+</b></div><div class="row"><div class="col-xs-12 u_margin-md-bottom" translate="" translate-values="{ planName: plan.name, priceDisplayMonth: plan.monthly.priceDisplayMonth }">common-header.purchase.review-subscription.need-more-displays</div><div class="col-xs-12"><div class="input-group spinner" ng-class="{ \'has-error\': form.reviewSubscriptionForm.additionalLicenses.$invalid }"><div class="input-group-btn-vertical"><button class="btn btn-white" type="button" ng-click="incrementLicenses()"><i class="fa fa-caret-up"></i></button> <button class="btn btn-white" type="button" ng-click="decrementLicenses()"><i class="fa fa-caret-down"></i></button></div><label for="additionalLicenses"><input id="additionalLicenses" name="additionalLicenses" type="number" class="form-control" ng-model="plan.additionalDisplayLicenses" min="0" max="999" pattern="[0-9]{1,3}" tabindex="1" aria-required="true" required=""> <span class="icon-right u_align-middle" translate="">common-header.purchase.review-subscription.additional-licenses</span></label></div></div><div class="col-xs-12"><hr></div><div class="col-xs-12 u_margin-sm-bottom"><b class="pull-left" translate="">common-header.purchase.review-subscription.total</b> <b class="pull-right" translate="">common-header.purchase.review-subscription.pay-yearly</b></div><div class="col-xs-12"><div class="panel payment-recurrence-selector" ng-class="{ \'has-error\': form.reviewSubscriptionForm.billingPeriod.$invalid }"><div class="radio" ng-class="{ active: plan.isMonthly }"><label for="monthlyBilling"><input type="radio" name="billingPeriod" id="monthlyBilling" ng-value="true" ng-model="plan.isMonthly" aria-required="true" tabindex="1" required=""> <span translate="" translate-values="{ monthlyPrice: getMonthlyPrice() }">common-header.purchase.review-subscription.billed-monthly</span></label></div><div class="radio" ng-class="{ active: !plan.isMonthly }"><label for="yearlyBilling"><input type="radio" name="billingPeriod" id="yearlyBilling" ng-value="false" ng-model="plan.isMonthly" aria-required="true" tabindex="1" required=""> <span translate="" translate-values="{ yearlyPrice: getYearlyPrice() }">common-header.purchase.review-subscription.billed-yearly</span></label><div class="label label-success" translate="" translate-values="{ saveYearly: plan.yearly.save }">common-header.purchase.review-subscription.save-yearly</div></div></div></div></div><hr><div class="row"><div class="col-xs-12"><button id="continueButton" type="submit" aria-label="Continue to Billing Address" tabindex="1" form="form.reviewSubscriptionForm" class="btn btn-primary pull-right" ng-click="setNextStep()" translate="">common.continue</button></div></div></form></div>')}])}(),function(e){try{e=angular.module("risevision.common.components.purchase-flow")}catch(t){e=angular.module("risevision.common.components.purchase-flow",[])}e.run(["$templateCache",function(e){e.put("purchase-flow/checkout-shipping-address.html",'<div id="checkout-shipping-address" class="address-editor"><form id="form.shippingAddressForm" role="form" class="u_margin-md-top" name="form.shippingAddressForm" autocomplete="on" novalidate=""><div class="alert alert-danger" ng-show="form.shippingAddressForm.$submitted && form.shippingAddressForm.$invalid">Please complete the missing information below.</div><div id="errorBox" class="alert alert-danger" role="alert" ng-show="shippingAddress.validationError"><strong>Address Validation Error</strong> {{shippingAddress.validationError}}</div><address-form form-object="form.shippingAddressForm" address-object="shippingAddress"></address-form><hr><div class="row"><div class="col-xs-12"><button id="backButton" aria-label="Go back to Billing Address" type="button" class="btn btn-default pull-left" ng-click="setPreviousStep()" ng-hide="finalStep" tabindex="2" translate="">common.back</button> <button id="continueButton" type="submit" form="form.shippingAddressForm" class="btn btn-primary pull-right" aria-label="Continue to Payment Method" ng-click="validateAddress(shippingAddress, null, true)" tabindex="1" translate="">common.continue</button></div></div></form></div>')}])}(),function(e){try{e=angular.module("risevision.common.components.purchase-flow")}catch(t){e=angular.module("risevision.common.components.purchase-flow",[])}e.run(["$templateCache",function(e){e.put("purchase-flow/checkout-success.html",'<div id="checkout-success"><h3 class="text-center u_margin-md-top">Payment Successful</h3><div class="text-center u_padding-md"><img src="https://s3.amazonaws.com/Rise-Images/Icons/online.svg" width="72px" alt="Payment Successful"><br><br><p>Your payment to Rise Vision was successful. You can keep track of your billing information in the <a ui-sref="apps.billing.home">Billing</a> section of your account.</p><br></div><hr><div class="row"><div class="col-xs-12 text-center"><button id="doneButton" class="btn btn-default" ng-click="close()" aria-label="Done" tabindex="1">Done</button></div></div></div>')}])}(),function(e){try{e=angular.module("risevision.common.components.purchase-flow")}catch(t){e=angular.module("risevision.common.components.purchase-flow",[])}e.run(["$templateCache",function(e){e.put("purchase-flow/purchase-modal.html",'<div rv-spinner="" rv-spinner-key="purchase-modal" rv-spinner-start-active="1"><div class="modal-header"><button type="button" class="close" ng-click="dismiss()" aria-label="close" tabindex="2" ng-hide="currentStep === 5"><i class="fa fa-times"></i></button><h3 class="modal-title" translate="">Checkout</h3></div><div class="steps"><div ng-repeat="step in PURCHASE_STEPS" class="step-item" ng-class="{ active: currentStep === step.index, complete: currentStep > step.index }"><span>{{step.name}}</span></div></div><div id="purchase-modal" class="modal-body checkout-modal" stop-event="touchend"><review-subscription ng-if="currentStep === 0"></review-subscription><billing-address ng-if="currentStep === 1"></billing-address><shipping-address ng-if="currentStep === 2"></shipping-address><payment-methods ng-if="currentStep === 3"></payment-methods><review-purchase ng-if="currentStep === 4"></review-purchase><checkout-success ng-if="currentStep === 5"></checkout-success></div><div id="security-branding" class="modal-footer text-center" ng-show="currentStep > 2 && currentStep < 5"><span class="text-muted"><i class="fa fa-lock icon-left"></i> Secure Checkout from ChargeBee and <img alt="powered by Stripe" height="16" src="https://s3.amazonaws.com/Rise-Images/UI/powered_by_stripe.svg"></span></div></div>')}])}(),function(e){try{e=angular.module("risevision.common.components.purchase-flow")}catch(t){e=angular.module("risevision.common.components.purchase-flow",[])}e.run(["$templateCache",function(e){e.put("purchase-flow/tax-exemption.html",'<div class="modal-header"><button ng-click="close()" type="button" class="close" aria-hidden="true"><i class="fa fa-times"></i></button><h3 class="modal-title">Add Tax Exemption</h3></div><div class="modal-body" rv-spinner="defaultSpinnerOptions" rv-spinner-key="tax-modal" rv-spinner-start-active="0"><div class="alert alert-info" ng-show="taxExemptionSubmitted">Your Tax Exemption Request has been submitted.</div><div class="alert alert-danger" ng-show="errors.length"><ul><li ng-repeat="error in errors">{{error}}</li></ul></div><form id="tax-exemption-form" role="form" class="u_margin-md-top" novalidate=""><div class="row"><div class="col-xs-12"><div class="form-group"><label class="control-label">Tax Exemption Number</label> <input type="text" class="form-control" ng-model="formData.number"></div></div></div><label class="control-label">Tax Exemption Document (Image or PDF only)</label><div class="row"><div class="col-xs-9"><div class="form-group"><div class="input-group"><input type="file" id="inputExemption" accept="application/pdf,image/*" onchange="angular.element(this).scope().setFile(this)" style="display:none"> <input class="form-control" readonly="readonly" type="text" name="" value="{{formData.file.name}}"> <a href="#" ng-click="clearFile()" class="btn btn-default input-group-addon"><i class="fa fa-times"></i></a></div></div></div><div class="col-xs-3"><button ng-click="selectFile()" class="btn btn-default">Attach File</button></div></div><div class="row"><div class="col-md-6"><div class="form-group"><label for="company-settings-country" class="control-label">Exemption Country</label><select id="company-settings-country" name="country" autocomplete="country" class="form-control" ng-model="formData.country" ng-options="c.code as c.name for c in countries | filter:countryFilter" empty-select-parser="" aria-required="true" tabindex="1" required=""><option ng-show="false" value="">&lt; Select Country &gt;</option></select></div></div><div class="col-md-6"><div class="form-group"><label for="company-settings-state" class="control-label">Exemption State/Province</label><select name="province-selector" class="form-control selectpicker" ng-model="formData.province" ng-options="c[1] as c[0] for c in regionsCA" autocomplete="address-level1" ng-show="formData.country === \'CA\'" empty-select-parser=""><option ng-show="false" value="">&lt; Select Province &gt;</option></select><select name="state-selector" class="form-control selectpicker" ng-model="formData.province" ng-options="c[1] as c[0] for c in regionsUS" autocomplete="address-level1" ng-show="formData.country === \'US\'" empty-select-parser=""><option ng-show="false" value="">&lt; Select State &gt;</option></select></div></div></div><div class="row"><div class="col-md-6"><div class="form-group"><label class="control-label">Exemption Expiry Date</label><div class="input-group"><input type="text" id="expiryDate" name="expiryDate" class="form-control" datepicker-popup="dd-MMM-yyyy" ng-model="formData.expiryDate" is-open="datepicker" min-date="today" ng-required="true" larger-than-date="" close-text="Close"> <span class="input-group-btn"><button type="button" class="btn btn-default" ng-click="openDatepicker($event)"><i class="fa fa-calendar"></i></button></span></div></div></div></div></form><hr></div><div class="modal-footer"><button ng-click="close()" ng-show="!taxExemptionSubmitted" class="btn btn-default pull-left">Cancel</button> <button ng-click="close()" ng-show="taxExemptionSubmitted" class="btn btn-default pull-left">Close</button> <button ng-click="submit()" class="btn btn-primary pull-right">Submit Tax Exemption</button></div>')}])}(),function(e){try{e=angular.module("risevision.common.components.purchase-flow")}catch(t){e=angular.module("risevision.common.components.purchase-flow",[])}e.run(["$templateCache",function(e){e.put("purchase-flow/year-selector.html",'<select ng-options="n as n for n in years"><option ng-show="false" value="">&lt; Select Year &gt;</option></select>')}])}();