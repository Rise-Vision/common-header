!function(){"use strict";try{angular.module("risevision.common.config")}catch(t){angular.module("risevision.common.config",[])}angular.module("risevision.common.config").value("STORE_URL","https://store.risevision.com/").value("STORE_SERVER_URL","https://store-dot-rvaserver2.appspot.com/"),angular.module("risevision.common.components.subscription-status.config",[]).value("IN_RVA_PATH","product/productId/?cid=companyId").value("ACCOUNT_PATH","account?cid=companyId").value("PATH_URL","v1/company/companyId/product/status?pc=").value("AUTH_PATH_URL","v1/widget/auth?cid=companyId&pc=").value("PATH_URL_BY_DISPLAY_ID","v1/product/productCode/status?displayIds="),angular.module("risevision.common.components.subscription-status.filters",["risevision.common.i18n"]),angular.module("risevision.common.components.subscription-status.directives",["risevision.common.components.subscription-status.service"]),angular.module("risevision.common.components.subscription-status",["ngSanitize","ui.bootstrap","risevision.common.config","risevision.common.components.subscription-status.config","risevision.common.components.subscription-status.directives","risevision.common.components.subscription-status.filters","risevision.common.components.subscription-status.service"])}(),function(){"use strict";angular.module("risevision.common.components.subscription-status.service",["risevision.common.config","risevision.common.components.subscription-status.config"]).service("subscriptionStatusService",["$http","$q","STORE_SERVER_URL","PATH_URL","AUTH_PATH_URL","PATH_URL_BY_DISPLAY_ID",function(t,s,n,e,i,o){function a(t,s){return Math.floor((s.getTime()-t.getTime())/c)}var r=["On Trial","Trial Expired","Subscribed","Suspended","Cancelled","Free","Not Subscribed","Product Not Found","Company Not Found","Error"],u=["on-trial","trial-expired","subscribed","suspended","cancelled","free","not-subscribed","product-not-found","company-not-found","error"],c=864e5,p=function(e,o){var a=s.defer(),r=n+i.replace("companyId",o)+e;return t.get(r).then(function(t){t&&t.data?a.resolve(t.data.authorized):a.resolve(!1)}),a.promise},d=function(i,c,p){var d=s.defer(),l=n+e.replace("companyId",c)+i;return p&&(l=n+o.replace("productCode",i)+p),t.get(l).then(function(t){if(t&&t.data&&t.data.length){var s=t.data[0];s.plural="";var n=r.indexOf(s.status);n>=0&&(s.statusCode=u[n]),""===s.status?(s.status="N/A",s.statusCode="na",s.subscribed=!1):s.status===r[0]||s.status===r[2]||s.status===r[5]?s.subscribed=!0:s.subscribed=!1,"not-subscribed"===s.statusCode&&s.trialPeriod&&s.trialPeriod>0&&(s.statusCode="trial-available",s.subscribed=!0),s.expiry&&"on-trial"===s.statusCode&&(s.expiry=new Date(s.expiry),s.expiry instanceof Date&&!isNaN(s.expiry.valueOf())&&(s.expiry=a(new Date,s.expiry)),0===s.expiry?s.plural="-zero":s.expiry>1&&(s.plural="-many")),d.resolve(s)}else d.reject("No response")}),d.promise};this.get=function(t,s,n){return d(t,s,n).then(function(n){return n.subscribed===!1?p(t,s).then(function(t){return n.subscribed=t,n}):n})}}])}(),function(){"use strict";angular.module("risevision.common.components.subscription-status.directives").directive("appSubscriptionStatus",["$templateCache","$modal","subscriptionStatusService",function(t,s,n){return{restrict:"AE",require:"?ngModel",scope:{productId:"@",productCode:"@",companyId:"@",productPrice:"@"},template:t.get("subscription-status/app-subscription-status-template.html"),link:function(t,e,i,o){function a(){t.productCode&&t.productId&&t.companyId&&n.get(t.productCode,t.companyId).then(function(s){s&&(t.subscriptionStatus=s)},function(){})}t.subscriptionStatus={status:"N/A",statusCode:"na",subscribed:!1,expiry:null},t.$watch("companyId",function(){a()}),o&&t.$watch("subscriptionStatus",function(t){o.$setViewValue(t)}),t.$watch("showStoreModal",function(n){if(n){var e=s.open({templateUrl:"store-iframe-template.html",controller:"StoreModalController",size:"lg",resolve:{productId:function(){return t.productId},companyId:function(){return t.companyId}}});e.result.then(function(){a()},function(){a()})["finally"](function(){t.showStoreModal=!1})}})}}}]).directive("ngDisableRightClick",function(){return function(t,s){s.bind("contextmenu",function(s){t.$apply(function(){s.preventDefault()})})}})}(),function(){"use strict";angular.module("risevision.common.components.subscription-status.directives").directive("subscriptionStatus",["$rootScope","$templateCache","subscriptionStatusService","STORE_URL","ACCOUNT_PATH","IN_RVA_PATH",function(t,s,n,e,i,o){return{restrict:"AE",require:"?ngModel",scope:{productId:"@",productCode:"@",companyId:"@",displayId:"@",expandedFormat:"@",showStoreModal:"=?",customProductLink:"@",customMessages:"@"},template:s.get("subscription-status/subscription-status-template.html"),link:function(s,a,r,u){function c(){s.productCode&&s.productId&&(s.companyId||s.displayId)&&n.get(s.productCode,s.companyId,s.displayId).then(function(n){n&&(s.subscriptionStatus&&s.subscriptionStatus.status===n.status||t.$emit("subscription-status:changed",n),s.subscriptionStatus=n)},function(){})}s.subscriptionStatus={status:"N/A",statusCode:"na",subscribed:!1,expiry:null},s.messagesPrefix=s.customMessages?s.customMessages:"subscription-status";var p=function(){s.storeAccountUrl=e+i.replace("companyId",s.companyId),s.customProductLink?s.storeUrl=s.customProductLink:s.storeUrl=e+o.replace("productId",s.productId).replace("companyId",s.companyId)};s.$watch("companyId",function(){c(),p()});var d=t.$on("refreshSubscriptionStatus",function(t,n){null!==n&&s.subscriptionStatus.statusCode!==n||c()});s.$on("$destroy",function(){d()}),u&&s.$watch("subscriptionStatus",function(t){u.$setViewValue(t)})}}}]).filter("to_trusted",["$sce",function(t){return function(s){return t.trustAsHtml(s)}}])}(),angular.module("risevision.common.components.subscription-status.filters").filter("productTrialDaysToExpiry",["$interpolate","$translate",function(t,s){var n=null,e=null;return s(["subscription-status.expires-today","subscription-status.expires-in"],{days:"{{days}}"}).then(function(s){n=t(s["subscription-status.expires-today"]),e=t(s["subscription-status.expires-in"])}),function(t){var s="";try{var i=864e5,o=new Date(t).getTime()-(new Date).getTime(),a=Math.floor(o/i),r={days:a};s=0===a?null!==n?n(r):"":a>0?null!==e?e(r):"":null!==n?n(r):""}catch(u){}return s}}]),function(t){try{t=angular.module("risevision.common.components.subscription-status")}catch(s){t=angular.module("risevision.common.components.subscription-status",[])}t.run(["$templateCache",function(t){t.put("subscription-status/app-subscription-status-template.html",'<a id="app-subscription-status" href="" ng-click="showStoreModal = true" class="store-link"><div class="rate"><strong>${{productPrice}}</strong></div><div class="subscribe"><strong ng-if="!subscriptionStatus.subscribed"><span translate="subscription-status.get-subscription"></span></strong> <strong ng-if="subscriptionStatus.subscribed"><span translate="subscription-status.continue-to-app"></span></strong></div></a>')}])}(),function(t){try{t=angular.module("risevision.common.components.subscription-status")}catch(s){t=angular.module("risevision.common.components.subscription-status",[])}t.run(["$templateCache",function(t){t.put("subscription-status/subscription-status-template.html",'<div ng-show="!expandedFormat"><h3 ng-disable-right-click=""><span ng-show="subscriptionStatus.statusCode !== \'not-subscribed\'" ng-bind-html="messagesPrefix + \'.\' + subscriptionStatus.statusCode + subscriptionStatus.plural | translate:subscriptionStatus | to_trusted"></span></h3><span ng-show="subscriptionStatus.statusCode === \'trial-available\'"><button class="btn btn-primary btn-xs" ng-click="showStoreModal = true;"><span translate="{{messagesPrefix}}.start-trial"></span></button></span> <span ng-show="[\'on-trial\', \'trial-expired\', \'cancelled\', \'not-subscribed\'].indexOf(subscriptionStatus.statusCode) >= 0"><a class="btn btn-primary btn-xs" ng-href="{{storeUrl}}" target="_blank"><span translate="{{messagesPrefix}}.subscribe"></span></a></span> <span ng-show="[\'suspended\'].indexOf(subscriptionStatus.statusCode) >= 0"><a type="button" class="btn btn-primary btn-xs" ng-href="{{storeAccountUrl}}" target="_blank"><span translate="{{messagesPrefix}}.view-account"></span></a></span></div><div ng-show="expandedFormat"><div class="subscription-status trial" ng-show="subscriptionStatus.statusCode === \'on-trial\'"><span ng-bind-html="messagesPrefix + \'.expanded-\' + subscriptionStatus.statusCode + subscriptionStatus.plural | translate:subscriptionStatus | to_trusted"></span> <a type="button" class="btn btn-primary u_margin-left" ng-href="{{storeUrl}}" target="_blank"><span translate="{{messagesPrefix}}.subscribe-now"></span></a></div><div class="subscription-status expired" ng-show="subscriptionStatus.statusCode === \'trial-expired\'"><span translate="{{messagesPrefix}}.expanded-expired"></span> <a type="button" class="btn btn-primary u_margin-left" ng-href="{{storeUrl}}" target="_blank"><span translate="{{messagesPrefix}}.subscribe-now"></span></a></div><div class="subscription-status cancelled" ng-show="subscriptionStatus.statusCode === \'cancelled\'"><span translate="{{messagesPrefix}}.expanded-cancelled"></span> <a type="button" class="btn btn-primary u_margin-left" ng-href="{{storeUrl}}" target="_blank"><span translate="{{messagesPrefix}}.subscribe-now"></span></a></div><div class="subscription-status suspended" ng-show="subscriptionStatus.statusCode === \'suspended\'"><span translate="{{messagesPrefix}}.expanded-suspended"></span> <a type="button" class="btn btn-primary u_margin-left" ng-href="{{storeAccountUrl}}" target="_blank"><span translate="{{messagesPrefix}}.view-invoices"></span></a></div></div>')}])}();